{
  "variant": "awq_marlin",
  "experiment": "quantization_nondeterminism_investigation",
  "timestamp": "2025-11-12T15:59:22.557423",
  "model": "Qwen/Qwen3-8B-AWQ",
  "quantization": "awq_marlin",
  "description": "AWQ INT4 with Marlin kernel",
  "config": {
    "tensor_parallel": 1,
    "max_model_len": 8192,
    "max_tokens": 50,
    "repetitions": 5,
    "temperature": 0.0,
    "seed": 42
  },
  "prompt_length": 3790,
  "baseline": {
    "stats": {
      "tokens_identical": true,
      "logprobs_exact": true,
      "l2_mean": 0.0,
      "l2_std": 0.0,
      "l2_max": 0.0,
      "l2_min": 0.0,
      "std_per_token_mean": 0.0,
      "std_per_token_max": 0.0,
      "std_per_token_min": 0.0
    },
    "tokens": [
      [
        151667,
        198,
        32313,
        11,
        358,
        1184,
        311,
        23643,
        419,
        15817,
        2197,
        911,
        279,
        15379,
        315,
        3460,
        4128,
        4119,
        11,
        862,
        10916,
        40482,
        11,
        323,
        58429,
        24154,
        13,
        6771,
        752,
        1191,
        553,
        14719,
        1495,
        279,
        5944,
        323,
        1376,
        3501,
        382,
        5338,
        11,
        279,
        16800,
        7289,
        279,
        6430,
        553,
        38586,
        279,
        82687
      ],
      [
        151667,
        198,
        32313,
        11,
        358,
        1184,
        311,
        23643,
        419,
        15817,
        2197,
        911,
        279,
        15379,
        315,
        3460,
        4128,
        4119,
        11,
        862,
        10916,
        40482,
        11,
        323,
        58429,
        24154,
        13,
        6771,
        752,
        1191,
        553,
        14719,
        1495,
        279,
        5944,
        323,
        1376,
        3501,
        382,
        5338,
        11,
        279,
        16800,
        7289,
        279,
        6430,
        553,
        38586,
        279,
        82687
      ],
      [
        151667,
        198,
        32313,
        11,
        358,
        1184,
        311,
        23643,
        419,
        15817,
        2197,
        911,
        279,
        15379,
        315,
        3460,
        4128,
        4119,
        11,
        862,
        10916,
        40482,
        11,
        323,
        58429,
        24154,
        13,
        6771,
        752,
        1191,
        553,
        14719,
        1495,
        279,
        5944,
        323,
        1376,
        3501,
        382,
        5338,
        11,
        279,
        16800,
        7289,
        279,
        6430,
        553,
        38586,
        279,
        82687
      ],
      [
        151667,
        198,
        32313,
        11,
        358,
        1184,
        311,
        23643,
        419,
        15817,
        2197,
        911,
        279,
        15379,
        315,
        3460,
        4128,
        4119,
        11,
        862,
        10916,
        40482,
        11,
        323,
        58429,
        24154,
        13,
        6771,
        752,
        1191,
        553,
        14719,
        1495,
        279,
        5944,
        323,
        1376,
        3501,
        382,
        5338,
        11,
        279,
        16800,
        7289,
        279,
        6430,
        553,
        38586,
        279,
        82687
      ],
      [
        151667,
        198,
        32313,
        11,
        358,
        1184,
        311,
        23643,
        419,
        15817,
        2197,
        911,
        279,
        15379,
        315,
        3460,
        4128,
        4119,
        11,
        862,
        10916,
        40482,
        11,
        323,
        58429,
        24154,
        13,
        6771,
        752,
        1191,
        553,
        14719,
        1495,
        279,
        5944,
        323,
        1376,
        3501,
        382,
        5338,
        11,
        279,
        16800,
        7289,
        279,
        6430,
        553,
        38586,
        279,
        82687
      ]
    ],
    "logprobs": [
      [
        -4.768370445162873e-07,
        -3.933898824470816e-06,
        -0.009688026271760464,
        0.0,
        -0.7244320511817932,
        -0.010923115536570549,
        -4.768370445162873e-07,
        -1.6299656629562378,
        -0.4608175754547119,
        -1.0219569206237793,
        -0.01766577921807766,
        -0.4625857472419739,
        -0.7272209525108337,
        -0.040980786085128784,
        -0.003246158827096224,
        -0.02737845666706562,
        -8.344646857949556e-07,
        -1.0609570381348021e-05,
        -0.32529354095458984,
        -0.5399866104125977,
        -0.00042274597217328846,
        -0.02339707873761654,
        -9.822363062994555e-05,
        -0.07281959801912308,
        -0.0016527815023437142,
        -5.722029527532868e-06,
        -0.0001567479339428246,
        -0.2586238980293274,
        -0.00565891619771719,
        -0.05783150717616081,
        -3.576278118089249e-07,
        -0.09576082229614258,
        -0.005075071472674608,
        -0.09873484820127487,
        -0.33784371614456177,
        -0.60967618227005,
        -0.529120683670044,
        -0.018419643864035606,
        -0.821130633354187,
        -0.2962062954902649,
        -1.4305104514278355e-06,
        -0.005158685147762299,
        -0.09500183165073395,
        -0.08170922100543976,
        -0.048591531813144684,
        -0.1280101090669632,
        -0.10883720219135284,
        -0.6562318205833435,
        -0.019367165863513947,
        -0.3531017601490021
      ],
      [
        -4.768370445162873e-07,
        -3.933898824470816e-06,
        -0.009688026271760464,
        0.0,
        -0.7244320511817932,
        -0.010923115536570549,
        -4.768370445162873e-07,
        -1.6299656629562378,
        -0.4608175754547119,
        -1.0219569206237793,
        -0.01766577921807766,
        -0.4625857472419739,
        -0.7272209525108337,
        -0.040980786085128784,
        -0.003246158827096224,
        -0.02737845666706562,
        -8.344646857949556e-07,
        -1.0609570381348021e-05,
        -0.32529354095458984,
        -0.5399866104125977,
        -0.00042274597217328846,
        -0.02339707873761654,
        -9.822363062994555e-05,
        -0.07281959801912308,
        -0.0016527815023437142,
        -5.722029527532868e-06,
        -0.0001567479339428246,
        -0.2586238980293274,
        -0.00565891619771719,
        -0.05783150717616081,
        -3.576278118089249e-07,
        -0.09576082229614258,
        -0.005075071472674608,
        -0.09873484820127487,
        -0.33784371614456177,
        -0.60967618227005,
        -0.529120683670044,
        -0.018419643864035606,
        -0.821130633354187,
        -0.2962062954902649,
        -1.4305104514278355e-06,
        -0.005158685147762299,
        -0.09500183165073395,
        -0.08170922100543976,
        -0.048591531813144684,
        -0.1280101090669632,
        -0.10883720219135284,
        -0.6562318205833435,
        -0.019367165863513947,
        -0.3531017601490021
      ],
      [
        -4.768370445162873e-07,
        -3.933898824470816e-06,
        -0.009688026271760464,
        0.0,
        -0.7244320511817932,
        -0.010923115536570549,
        -4.768370445162873e-07,
        -1.6299656629562378,
        -0.4608175754547119,
        -1.0219569206237793,
        -0.01766577921807766,
        -0.4625857472419739,
        -0.7272209525108337,
        -0.040980786085128784,
        -0.003246158827096224,
        -0.02737845666706562,
        -8.344646857949556e-07,
        -1.0609570381348021e-05,
        -0.32529354095458984,
        -0.5399866104125977,
        -0.00042274597217328846,
        -0.02339707873761654,
        -9.822363062994555e-05,
        -0.07281959801912308,
        -0.0016527815023437142,
        -5.722029527532868e-06,
        -0.0001567479339428246,
        -0.2586238980293274,
        -0.00565891619771719,
        -0.05783150717616081,
        -3.576278118089249e-07,
        -0.09576082229614258,
        -0.005075071472674608,
        -0.09873484820127487,
        -0.33784371614456177,
        -0.60967618227005,
        -0.529120683670044,
        -0.018419643864035606,
        -0.821130633354187,
        -0.2962062954902649,
        -1.4305104514278355e-06,
        -0.005158685147762299,
        -0.09500183165073395,
        -0.08170922100543976,
        -0.048591531813144684,
        -0.1280101090669632,
        -0.10883720219135284,
        -0.6562318205833435,
        -0.019367165863513947,
        -0.3531017601490021
      ],
      [
        -4.768370445162873e-07,
        -3.933898824470816e-06,
        -0.009688026271760464,
        0.0,
        -0.7244320511817932,
        -0.010923115536570549,
        -4.768370445162873e-07,
        -1.6299656629562378,
        -0.4608175754547119,
        -1.0219569206237793,
        -0.01766577921807766,
        -0.4625857472419739,
        -0.7272209525108337,
        -0.040980786085128784,
        -0.003246158827096224,
        -0.02737845666706562,
        -8.344646857949556e-07,
        -1.0609570381348021e-05,
        -0.32529354095458984,
        -0.5399866104125977,
        -0.00042274597217328846,
        -0.02339707873761654,
        -9.822363062994555e-05,
        -0.07281959801912308,
        -0.0016527815023437142,
        -5.722029527532868e-06,
        -0.0001567479339428246,
        -0.2586238980293274,
        -0.00565891619771719,
        -0.05783150717616081,
        -3.576278118089249e-07,
        -0.09576082229614258,
        -0.005075071472674608,
        -0.09873484820127487,
        -0.33784371614456177,
        -0.60967618227005,
        -0.529120683670044,
        -0.018419643864035606,
        -0.821130633354187,
        -0.2962062954902649,
        -1.4305104514278355e-06,
        -0.005158685147762299,
        -0.09500183165073395,
        -0.08170922100543976,
        -0.048591531813144684,
        -0.1280101090669632,
        -0.10883720219135284,
        -0.6562318205833435,
        -0.019367165863513947,
        -0.3531017601490021
      ],
      [
        -4.768370445162873e-07,
        -3.933898824470816e-06,
        -0.009688026271760464,
        0.0,
        -0.7244320511817932,
        -0.010923115536570549,
        -4.768370445162873e-07,
        -1.6299656629562378,
        -0.4608175754547119,
        -1.0219569206237793,
        -0.01766577921807766,
        -0.4625857472419739,
        -0.7272209525108337,
        -0.040980786085128784,
        -0.003246158827096224,
        -0.02737845666706562,
        -8.344646857949556e-07,
        -1.0609570381348021e-05,
        -0.32529354095458984,
        -0.5399866104125977,
        -0.00042274597217328846,
        -0.02339707873761654,
        -9.822363062994555e-05,
        -0.07281959801912308,
        -0.0016527815023437142,
        -5.722029527532868e-06,
        -0.0001567479339428246,
        -0.2586238980293274,
        -0.00565891619771719,
        -0.05783150717616081,
        -3.576278118089249e-07,
        -0.09576082229614258,
        -0.005075071472674608,
        -0.09873484820127487,
        -0.33784371614456177,
        -0.60967618227005,
        -0.529120683670044,
        -0.018419643864035606,
        -0.821130633354187,
        -0.2962062954902649,
        -1.4305104514278355e-06,
        -0.005158685147762299,
        -0.09500183165073395,
        -0.08170922100543976,
        -0.048591531813144684,
        -0.1280101090669632,
        -0.10883720219135284,
        -0.6562318205833435,
        -0.019367165863513947,
        -0.3531017601490021
      ]
    ]
  },
  "deterministic": {
    "succeeded": true,
    "stats": {
      "tokens_identical": true,
      "logprobs_exact": true,
      "l2_mean": 0.0,
      "l2_std": 0.0,
      "l2_max": 0.0,
      "l2_min": 0.0,
      "std_per_token_mean": 0.0,
      "std_per_token_max": 0.0,
      "std_per_token_min": 0.0
    },
    "tokens": [
      [
        151667,
        198,
        32313,
        11,
        358,
        1184,
        311,
        23643,
        419,
        15817,
        2197,
        911,
        279,
        15379,
        315,
        3460,
        4128,
        4119,
        11,
        862,
        10916,
        40482,
        11,
        323,
        58429,
        24154,
        13,
        6771,
        752,
        1191,
        553,
        14719,
        1495,
        279,
        5944,
        323,
        1376,
        3501,
        382,
        5338,
        11,
        279,
        16800,
        7289,
        279,
        6430,
        553,
        38586,
        279,
        82687
      ],
      [
        151667,
        198,
        32313,
        11,
        358,
        1184,
        311,
        23643,
        419,
        15817,
        2197,
        911,
        279,
        15379,
        315,
        3460,
        4128,
        4119,
        11,
        862,
        10916,
        40482,
        11,
        323,
        58429,
        24154,
        13,
        6771,
        752,
        1191,
        553,
        14719,
        1495,
        279,
        5944,
        323,
        1376,
        3501,
        382,
        5338,
        11,
        279,
        16800,
        7289,
        279,
        6430,
        553,
        38586,
        279,
        82687
      ],
      [
        151667,
        198,
        32313,
        11,
        358,
        1184,
        311,
        23643,
        419,
        15817,
        2197,
        911,
        279,
        15379,
        315,
        3460,
        4128,
        4119,
        11,
        862,
        10916,
        40482,
        11,
        323,
        58429,
        24154,
        13,
        6771,
        752,
        1191,
        553,
        14719,
        1495,
        279,
        5944,
        323,
        1376,
        3501,
        382,
        5338,
        11,
        279,
        16800,
        7289,
        279,
        6430,
        553,
        38586,
        279,
        82687
      ],
      [
        151667,
        198,
        32313,
        11,
        358,
        1184,
        311,
        23643,
        419,
        15817,
        2197,
        911,
        279,
        15379,
        315,
        3460,
        4128,
        4119,
        11,
        862,
        10916,
        40482,
        11,
        323,
        58429,
        24154,
        13,
        6771,
        752,
        1191,
        553,
        14719,
        1495,
        279,
        5944,
        323,
        1376,
        3501,
        382,
        5338,
        11,
        279,
        16800,
        7289,
        279,
        6430,
        553,
        38586,
        279,
        82687
      ],
      [
        151667,
        198,
        32313,
        11,
        358,
        1184,
        311,
        23643,
        419,
        15817,
        2197,
        911,
        279,
        15379,
        315,
        3460,
        4128,
        4119,
        11,
        862,
        10916,
        40482,
        11,
        323,
        58429,
        24154,
        13,
        6771,
        752,
        1191,
        553,
        14719,
        1495,
        279,
        5944,
        323,
        1376,
        3501,
        382,
        5338,
        11,
        279,
        16800,
        7289,
        279,
        6430,
        553,
        38586,
        279,
        82687
      ]
    ],
    "logprobs": [
      [
        -4.768370445162873e-07,
        -3.933898824470816e-06,
        -0.009688026271760464,
        0.0,
        -0.7244320511817932,
        -0.010923115536570549,
        -4.768370445162873e-07,
        -1.6299656629562378,
        -0.4608175754547119,
        -1.0219569206237793,
        -0.01766577921807766,
        -0.4625857472419739,
        -0.7272209525108337,
        -0.040980786085128784,
        -0.003246158827096224,
        -0.02737845666706562,
        -8.344646857949556e-07,
        -1.0609570381348021e-05,
        -0.32529354095458984,
        -0.5399866104125977,
        -0.00042274597217328846,
        -0.02339707873761654,
        -9.822363062994555e-05,
        -0.07281959801912308,
        -0.0016527815023437142,
        -5.722029527532868e-06,
        -0.0001567479339428246,
        -0.2586238980293274,
        -0.00565891619771719,
        -0.05783150717616081,
        -3.576278118089249e-07,
        -0.09576082229614258,
        -0.005075071472674608,
        -0.09873484820127487,
        -0.33784371614456177,
        -0.60967618227005,
        -0.529120683670044,
        -0.018419643864035606,
        -0.821130633354187,
        -0.2962062954902649,
        -1.4305104514278355e-06,
        -0.005158685147762299,
        -0.09500183165073395,
        -0.08170922100543976,
        -0.048591531813144684,
        -0.1280101090669632,
        -0.10883720219135284,
        -0.6562318205833435,
        -0.019367165863513947,
        -0.3531017601490021
      ],
      [
        -4.768370445162873e-07,
        -3.933898824470816e-06,
        -0.009688026271760464,
        0.0,
        -0.7244320511817932,
        -0.010923115536570549,
        -4.768370445162873e-07,
        -1.6299656629562378,
        -0.4608175754547119,
        -1.0219569206237793,
        -0.01766577921807766,
        -0.4625857472419739,
        -0.7272209525108337,
        -0.040980786085128784,
        -0.003246158827096224,
        -0.02737845666706562,
        -8.344646857949556e-07,
        -1.0609570381348021e-05,
        -0.32529354095458984,
        -0.5399866104125977,
        -0.00042274597217328846,
        -0.02339707873761654,
        -9.822363062994555e-05,
        -0.07281959801912308,
        -0.0016527815023437142,
        -5.722029527532868e-06,
        -0.0001567479339428246,
        -0.2586238980293274,
        -0.00565891619771719,
        -0.05783150717616081,
        -3.576278118089249e-07,
        -0.09576082229614258,
        -0.005075071472674608,
        -0.09873484820127487,
        -0.33784371614456177,
        -0.60967618227005,
        -0.529120683670044,
        -0.018419643864035606,
        -0.821130633354187,
        -0.2962062954902649,
        -1.4305104514278355e-06,
        -0.005158685147762299,
        -0.09500183165073395,
        -0.08170922100543976,
        -0.048591531813144684,
        -0.1280101090669632,
        -0.10883720219135284,
        -0.6562318205833435,
        -0.019367165863513947,
        -0.3531017601490021
      ],
      [
        -4.768370445162873e-07,
        -3.933898824470816e-06,
        -0.009688026271760464,
        0.0,
        -0.7244320511817932,
        -0.010923115536570549,
        -4.768370445162873e-07,
        -1.6299656629562378,
        -0.4608175754547119,
        -1.0219569206237793,
        -0.01766577921807766,
        -0.4625857472419739,
        -0.7272209525108337,
        -0.040980786085128784,
        -0.003246158827096224,
        -0.02737845666706562,
        -8.344646857949556e-07,
        -1.0609570381348021e-05,
        -0.32529354095458984,
        -0.5399866104125977,
        -0.00042274597217328846,
        -0.02339707873761654,
        -9.822363062994555e-05,
        -0.07281959801912308,
        -0.0016527815023437142,
        -5.722029527532868e-06,
        -0.0001567479339428246,
        -0.2586238980293274,
        -0.00565891619771719,
        -0.05783150717616081,
        -3.576278118089249e-07,
        -0.09576082229614258,
        -0.005075071472674608,
        -0.09873484820127487,
        -0.33784371614456177,
        -0.60967618227005,
        -0.529120683670044,
        -0.018419643864035606,
        -0.821130633354187,
        -0.2962062954902649,
        -1.4305104514278355e-06,
        -0.005158685147762299,
        -0.09500183165073395,
        -0.08170922100543976,
        -0.048591531813144684,
        -0.1280101090669632,
        -0.10883720219135284,
        -0.6562318205833435,
        -0.019367165863513947,
        -0.3531017601490021
      ],
      [
        -4.768370445162873e-07,
        -3.933898824470816e-06,
        -0.009688026271760464,
        0.0,
        -0.7244320511817932,
        -0.010923115536570549,
        -4.768370445162873e-07,
        -1.6299656629562378,
        -0.4608175754547119,
        -1.0219569206237793,
        -0.01766577921807766,
        -0.4625857472419739,
        -0.7272209525108337,
        -0.040980786085128784,
        -0.003246158827096224,
        -0.02737845666706562,
        -8.344646857949556e-07,
        -1.0609570381348021e-05,
        -0.32529354095458984,
        -0.5399866104125977,
        -0.00042274597217328846,
        -0.02339707873761654,
        -9.822363062994555e-05,
        -0.07281959801912308,
        -0.0016527815023437142,
        -5.722029527532868e-06,
        -0.0001567479339428246,
        -0.2586238980293274,
        -0.00565891619771719,
        -0.05783150717616081,
        -3.576278118089249e-07,
        -0.09576082229614258,
        -0.005075071472674608,
        -0.09873484820127487,
        -0.33784371614456177,
        -0.60967618227005,
        -0.529120683670044,
        -0.018419643864035606,
        -0.821130633354187,
        -0.2962062954902649,
        -1.4305104514278355e-06,
        -0.005158685147762299,
        -0.09500183165073395,
        -0.08170922100543976,
        -0.048591531813144684,
        -0.1280101090669632,
        -0.10883720219135284,
        -0.6562318205833435,
        -0.019367165863513947,
        -0.3531017601490021
      ],
      [
        -4.768370445162873e-07,
        -3.933898824470816e-06,
        -0.009688026271760464,
        0.0,
        -0.7244320511817932,
        -0.010923115536570549,
        -4.768370445162873e-07,
        -1.6299656629562378,
        -0.4608175754547119,
        -1.0219569206237793,
        -0.01766577921807766,
        -0.4625857472419739,
        -0.7272209525108337,
        -0.040980786085128784,
        -0.003246158827096224,
        -0.02737845666706562,
        -8.344646857949556e-07,
        -1.0609570381348021e-05,
        -0.32529354095458984,
        -0.5399866104125977,
        -0.00042274597217328846,
        -0.02339707873761654,
        -9.822363062994555e-05,
        -0.07281959801912308,
        -0.0016527815023437142,
        -5.722029527532868e-06,
        -0.0001567479339428246,
        -0.2586238980293274,
        -0.00565891619771719,
        -0.05783150717616081,
        -3.576278118089249e-07,
        -0.09576082229614258,
        -0.005075071472674608,
        -0.09873484820127487,
        -0.33784371614456177,
        -0.60967618227005,
        -0.529120683670044,
        -0.018419643864035606,
        -0.821130633354187,
        -0.2962062954902649,
        -1.4305104514278355e-06,
        -0.005158685147762299,
        -0.09500183165073395,
        -0.08170922100543976,
        -0.048591531813144684,
        -0.1280101090669632,
        -0.10883720219135284,
        -0.6562318205833435,
        -0.019367165863513947,
        -0.3531017601490021
      ]
    ]
  },
  "kernels": {
    "profiling_succeeded": true,
    "all_kernels": [],
    "marlin_kernels": [],
    "gemm_kernels": [],
    "dequant_kernels": []
  },
  "verdict": {
    "is_deterministic": true,
    "deterministic_mode_tested": true,
    "summary": "BASELINE IS DETERMINISTIC",
    "root_cause": "Fully deterministic behavior",
    "forensic_implications": "Perfect reproducibility - any deviation indicates computational change",
    "details": [
      "Unexpected for awq_marlin! May have been fixed in recent vLLM version"
    ]
  },
  "success": true
}