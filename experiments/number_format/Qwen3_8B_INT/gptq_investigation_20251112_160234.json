{
  "variant": "gptq",
  "experiment": "quantization_nondeterminism_investigation",
  "timestamp": "2025-11-12T16:02:34.551625",
  "model": "JunHowie/Qwen3-8B-GPTQ-Int4",
  "quantization": "gptq",
  "description": "GPTQ INT4 without Marlin kernel",
  "config": {
    "tensor_parallel": 1,
    "max_model_len": 8192,
    "max_tokens": 50,
    "repetitions": 5,
    "temperature": 0.0,
    "seed": 42
  },
  "prompt_length": 3790,
  "baseline": {
    "stats": {
      "tokens_identical": true,
      "logprobs_exact": false,
      "l2_mean": 0.029694963356962718,
      "l2_std": 0.0009641844560952147,
      "l2_max": 0.031094061690251182,
      "l2_min": 0.02871476672189155,
      "std_per_token_mean": 0.0013864540671006454,
      "std_per_token_max": 0.007167924198679026,
      "std_per_token_min": 0.0
    },
    "tokens": [
      [
        151667,
        198,
        32313,
        11,
        773,
        358,
        1184,
        311,
        3270,
        264,
        12126,
        315,
        419,
        1293,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        5290,
        1526,
        279,
        16800,
        311,
        633,
        279,
        1887,
        3501,
        13,
        576,
        2197,
        13433,
        911,
        279,
        10916,
        40482,
        315,
        444,
        10994,
        82,
        11,
        1075,
        279,
        42578,
        17646
      ],
      [
        151667,
        198,
        32313,
        11,
        773,
        358,
        1184,
        311,
        3270,
        264,
        12126,
        315,
        419,
        1293,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        5290,
        1526,
        279,
        16800,
        311,
        633,
        279,
        1887,
        3501,
        13,
        576,
        2197,
        13433,
        911,
        279,
        10916,
        40482,
        315,
        444,
        10994,
        82,
        11,
        1075,
        279,
        42578,
        17646
      ],
      [
        151667,
        198,
        32313,
        11,
        773,
        358,
        1184,
        311,
        3270,
        264,
        12126,
        315,
        419,
        1293,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        5290,
        1526,
        279,
        16800,
        311,
        633,
        279,
        1887,
        3501,
        13,
        576,
        2197,
        13433,
        911,
        279,
        10916,
        40482,
        315,
        444,
        10994,
        82,
        11,
        1075,
        279,
        42578,
        17646
      ],
      [
        151667,
        198,
        32313,
        11,
        773,
        358,
        1184,
        311,
        3270,
        264,
        12126,
        315,
        419,
        1293,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        5290,
        1526,
        279,
        16800,
        311,
        633,
        279,
        1887,
        3501,
        13,
        576,
        2197,
        13433,
        911,
        279,
        10916,
        40482,
        315,
        444,
        10994,
        82,
        11,
        1075,
        279,
        42578,
        17646
      ],
      [
        151667,
        198,
        32313,
        11,
        773,
        358,
        1184,
        311,
        3270,
        264,
        12126,
        315,
        419,
        1293,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        5290,
        1526,
        279,
        16800,
        311,
        633,
        279,
        1887,
        3501,
        13,
        576,
        2197,
        13433,
        911,
        279,
        10916,
        40482,
        315,
        444,
        10994,
        82,
        11,
        1075,
        279,
        42578,
        17646
      ]
    ],
    "logprobs": [
      [
        -1.5497195136049413e-06,
        -1.1920928244535389e-07,
        -0.018183909356594086,
        -5.960462772236497e-07,
        -0.9732434749603271,
        -0.042429130524396896,
        -0.10093124210834503,
        -1.1920928244535389e-07,
        -0.9263901710510254,
        -0.4107097387313843,
        -1.2166471481323242,
        -0.07511461526155472,
        -0.061903297901153564,
        -1.2547212839126587,
        -0.07658815383911133,
        -0.013452946208417416,
        -0.27890893816947937,
        -2.145764938177308e-06,
        -1.9788545614574105e-05,
        -0.2327466607093811,
        -0.009456838481128216,
        -0.00019739109848160297,
        -0.09112522751092911,
        -2.3841855067985307e-07,
        -0.1982480138540268,
        -0.00038818930624984205,
        -0.1455116719007492,
        -0.9851587414741516,
        -0.6261324286460876,
        -0.024951443076133728,
        -0.3196587860584259,
        -0.12955211102962494,
        -0.04734232276678085,
        -0.0731959268450737,
        -0.030898692086338997,
        -0.36834725737571716,
        -0.35542917251586914,
        -1.537788011773955e-05,
        -0.050741542130708694,
        -0.1325111985206604,
        -0.06068430840969086,
        -0.0572689063847065,
        -1.0503031015396118,
        -2.90866428258596e-05,
        -7.152555099310121e-07,
        -0.0273002777248621,
        -0.5708076357841492,
        -0.0055140540935099125,
        -0.09449295699596405,
        -1.0251946150674485e-05
      ],
      [
        -1.5497195136049413e-06,
        -1.1920928244535389e-07,
        -0.01819608360528946,
        -5.960462772236497e-07,
        -0.9684782028198242,
        -0.041149433702230453,
        -0.09924502670764923,
        -1.1920928244535389e-07,
        -0.9312989711761475,
        -0.4147086441516876,
        -1.2092207670211792,
        -0.07587148994207382,
        -0.06177521124482155,
        -1.2393566370010376,
        -0.0765811949968338,
        -0.013246272690594196,
        -0.27797362208366394,
        -2.145764938177308e-06,
        -2.0503786799963564e-05,
        -0.23448947072029114,
        -0.009168427437543869,
        -0.00019739109848160297,
        -0.09153302758932114,
        -2.3841855067985307e-07,
        -0.2006157785654068,
        -0.0003943857445847243,
        -0.14356429874897003,
        -0.9955990314483643,
        -0.6261287927627563,
        -0.02577337808907032,
        -0.30923399329185486,
        -0.12950864434242249,
        -0.047721318900585175,
        -0.07210089266300201,
        -0.029950931668281555,
        -0.36322829127311707,
        -0.3509402871131897,
        -1.4662635294371285e-05,
        -0.05078437179327011,
        -0.13077077269554138,
        -0.06066512316465378,
        -0.05639348551630974,
        -1.039453387260437,
        -2.90866428258596e-05,
        -7.152555099310121e-07,
        -0.026884449645876884,
        -0.5774833559989929,
        -0.005424186121672392,
        -0.09881001710891724,
        -1.0609570381348021e-05
      ],
      [
        -1.5497195136049413e-06,
        -1.1920928244535389e-07,
        -0.018185196444392204,
        -5.960462772236497e-07,
        -0.9641315937042236,
        -0.041149433702230453,
        -0.10153744369745255,
        -1.1920928244535389e-07,
        -0.9302624464035034,
        -0.41007155179977417,
        -1.2146825790405273,
        -0.07530789077281952,
        -0.06277906149625778,
        -1.2534610033035278,
        -0.07652819156646729,
        -0.01342589408159256,
        -0.278909295797348,
        -2.0265558760002023e-06,
        -1.9550132492440753e-05,
        -0.23448683321475983,
        -0.009295281954109669,
        -0.00019441144831944257,
        -0.09145568311214447,
        -2.3841855067985307e-07,
        -0.20085276663303375,
        -0.00040522945346310735,
        -0.141401007771492,
        -1.0009918212890625,
        -0.6228825449943542,
        -0.025744101032614708,
        -0.3176420032978058,
        -0.12584638595581055,
        -0.04675467684864998,
        -0.07430669665336609,
        -0.030333565548062325,
        -0.3585604131221771,
        -0.35346078872680664,
        -1.490105023549404e-05,
        -0.05038375407457352,
        -0.13093392550945282,
        -0.0606810562312603,
        -0.05657656118273735,
        -1.0312364101409912,
        -2.95634672511369e-05,
        -7.152555099310121e-07,
        -0.02729041688144207,
        -0.5685900449752808,
        -0.005487379152327776,
        -0.09880947321653366,
        -1.0251946150674485e-05
      ],
      [
        -1.5497195136049413e-06,
        -1.1920928244535389e-07,
        -0.018184026703238487,
        -5.960462772236497e-07,
        -0.9734458923339844,
        -0.04114805907011032,
        -0.09829864650964737,
        -1.1920928244535389e-07,
        -0.9392126798629761,
        -0.4100726544857025,
        -1.2103456258773804,
        -0.07487417757511139,
        -0.06270371377468109,
        -1.2390022277832031,
        -0.07607677578926086,
        -0.013452005572617054,
        -0.276064395904541,
        -2.0265558760002023e-06,
        -1.9550132492440753e-05,
        -0.23418769240379333,
        -0.009584718383848667,
        -0.00019739109848160297,
        -0.08990083634853363,
        -3.576278118089249e-07,
        -0.19780881702899933,
        -0.0003883084573317319,
        -0.14348550140857697,
        -0.9853933453559875,
        -0.619008481502533,
        -0.025759553536772728,
        -0.3176420032978058,
        -0.12249704450368881,
        -0.046543169766664505,
        -0.07543326169252396,
        -0.03119615651667118,
        -0.363018274307251,
        -0.3546314537525177,
        -1.490105023549404e-05,
        -0.050763413310050964,
        -0.13092419505119324,
        -0.060693394392728806,
        -0.057098232209682465,
        -1.035842776298523,
        -2.90866428258596e-05,
        -7.152555099310121e-07,
        -0.02731083333492279,
        -0.5727171301841736,
        -0.0054825181141495705,
        -0.09591159224510193,
        -1.0251946150674485e-05
      ],
      [
        -1.5497195136049413e-06,
        -1.1920928244535389e-07,
        -0.017371995374560356,
        -5.960462772236497e-07,
        -0.9592535495758057,
        -0.04178508371114731,
        -0.098564513027668,
        -1.1920928244535389e-07,
        -0.9322881698608398,
        -0.4094550907611847,
        -1.2201961278915405,
        -0.07538262754678726,
        -0.061834607273340225,
        -1.2401468753814697,
        -0.07533420622348785,
        -0.013642054982483387,
        -0.27985066175460815,
        -2.145764938177308e-06,
        -2.0146166207268834e-05,
        -0.2341925948858261,
        -0.00960538163781166,
        -0.0001854724541772157,
        -0.09131848812103271,
        -2.3841855067985307e-07,
        -0.1999567747116089,
        -0.0003935516288038343,
        -0.14545796811580658,
        -0.989276647567749,
        -0.613614559173584,
        -0.02570239268243313,
        -0.3196587860584259,
        -0.12592479586601257,
        -0.04762902855873108,
        -0.07319559901952744,
        -0.03041752241551876,
        -0.362653523683548,
        -0.3552558720111847,
        -1.4424220353248529e-05,
        -0.049996357411146164,
        -0.13098548352718353,
        -0.06068318709731102,
        -0.05726541951298714,
        -1.0339152812957764,
        -2.95634672511369e-05,
        -7.152555099310121e-07,
        -0.027292272076010704,
        -0.572769284248352,
        -0.005453471094369888,
        -0.09449393302202225,
        -1.07287787614041e-05
      ]
    ]
  },
  "deterministic": {
    "succeeded": true,
    "stats": {
      "tokens_identical": true,
      "logprobs_exact": false,
      "l2_mean": 0.024056458826954133,
      "l2_std": 0.004068369648901686,
      "l2_max": 0.02974235672030325,
      "l2_min": 0.01937820543399819,
      "std_per_token_mean": 0.0012199777487759823,
      "std_per_token_max": 0.006271982300571814,
      "std_per_token_min": 0.0
    },
    "tokens": [
      [
        151667,
        198,
        32313,
        11,
        773,
        358,
        1184,
        311,
        3270,
        264,
        12126,
        315,
        419,
        1293,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        5290,
        1526,
        279,
        16800,
        311,
        633,
        279,
        1887,
        3501,
        13,
        576,
        2197,
        13433,
        911,
        279,
        10916,
        40482,
        315,
        444,
        10994,
        82,
        11,
        1075,
        279,
        42578,
        17646
      ],
      [
        151667,
        198,
        32313,
        11,
        773,
        358,
        1184,
        311,
        3270,
        264,
        12126,
        315,
        419,
        1293,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        5290,
        1526,
        279,
        16800,
        311,
        633,
        279,
        1887,
        3501,
        13,
        576,
        2197,
        13433,
        911,
        279,
        10916,
        40482,
        315,
        444,
        10994,
        82,
        11,
        1075,
        279,
        42578,
        17646
      ],
      [
        151667,
        198,
        32313,
        11,
        773,
        358,
        1184,
        311,
        3270,
        264,
        12126,
        315,
        419,
        1293,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        5290,
        1526,
        279,
        16800,
        311,
        633,
        279,
        1887,
        3501,
        13,
        576,
        2197,
        13433,
        911,
        279,
        10916,
        40482,
        315,
        444,
        10994,
        82,
        11,
        1075,
        279,
        42578,
        17646
      ],
      [
        151667,
        198,
        32313,
        11,
        773,
        358,
        1184,
        311,
        3270,
        264,
        12126,
        315,
        419,
        1293,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        5290,
        1526,
        279,
        16800,
        311,
        633,
        279,
        1887,
        3501,
        13,
        576,
        2197,
        13433,
        911,
        279,
        10916,
        40482,
        315,
        444,
        10994,
        82,
        11,
        1075,
        279,
        42578,
        17646
      ],
      [
        151667,
        198,
        32313,
        11,
        773,
        358,
        1184,
        311,
        3270,
        264,
        12126,
        315,
        419,
        1293,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        5290,
        1526,
        279,
        16800,
        311,
        633,
        279,
        1887,
        3501,
        13,
        576,
        2197,
        13433,
        911,
        279,
        10916,
        40482,
        315,
        444,
        10994,
        82,
        11,
        1075,
        279,
        42578,
        17646
      ]
    ],
    "logprobs": [
      [
        -1.5497195136049413e-06,
        -1.1920928244535389e-07,
        -0.018751494586467743,
        -5.960462772236497e-07,
        -0.9633605480194092,
        -0.04242479056119919,
        -0.09825855493545532,
        -1.1920928244535389e-07,
        -0.927629292011261,
        -0.4094623029232025,
        -1.2022194862365723,
        -0.07464441657066345,
        -0.06277178227901459,
        -1.238465428352356,
        -0.07671104371547699,
        -0.013059441931545734,
        -0.27422699332237244,
        -2.145764938177308e-06,
        -1.9192511899746023e-05,
        -0.23508869111537933,
        -0.009276148863136768,
        -0.00019131260341964662,
        -0.09031512588262558,
        -2.3841855067985307e-07,
        -0.20089508593082428,
        -0.00039521988946944475,
        -0.1455698013305664,
        -0.9861725568771362,
        -0.6190156936645508,
        -0.025741081684827805,
        -0.31120526790618896,
        -0.12932388484477997,
        -0.04800336807966232,
        -0.0731959268450737,
        -0.030207501724362373,
        -0.35889169573783875,
        -0.3555884063243866,
        -1.4662635294371285e-05,
        -0.050386250019073486,
        -0.13081155717372894,
        -0.060692496597766876,
        -0.0565960519015789,
        -1.0384094715118408,
        -2.90866428258596e-05,
        -7.152555099310121e-07,
        -0.027297724038362503,
        -0.5707191824913025,
        -0.005452285520732403,
        -0.09735222905874252,
        -1.07287787614041e-05
      ],
      [
        -1.5497195136049413e-06,
        -1.1920928244535389e-07,
        -0.01790233701467514,
        -5.960462772236497e-07,
        -0.9688106775283813,
        -0.04242821782827377,
        -0.09919515252113342,
        -1.1920928244535389e-07,
        -0.9343401193618774,
        -0.4094773530960083,
        -1.2123878002166748,
        -0.07532790303230286,
        -0.0636667013168335,
        -1.2433505058288574,
        -0.07598872482776642,
        -0.013435068540275097,
        -0.2751583755016327,
        -2.145764938177308e-06,
        -1.9788545614574105e-05,
        -0.2344951182603836,
        -0.00943676382303238,
        -0.00019441144831944257,
        -0.09018529206514359,
        -3.576278118089249e-07,
        -0.20272782444953918,
        -0.00040522945346310735,
        -0.14142759144306183,
        -0.9989781379699707,
        -0.6261341571807861,
        -0.02574131451547146,
        -0.30923399329185486,
        -0.12574023008346558,
        -0.04681849852204323,
        -0.07210111618041992,
        -0.03050251305103302,
        -0.3629666864871979,
        -0.3518441319465637,
        -1.5616295058862306e-05,
        -0.049998171627521515,
        -0.13087515532970428,
        -0.06066332757472992,
        -0.05693056434392929,
        -1.0259087085723877,
        -2.95634672511369e-05,
        -7.152555099310121e-07,
        -0.02727394551038742,
        -0.5754860043525696,
        -0.0054825181141495705,
        -0.09591159224510193,
        -1.0132738680113107e-05
      ],
      [
        -1.5497195136049413e-06,
        -1.1920928244535389e-07,
        -0.017641769722104073,
        -5.960462772236497e-07,
        -0.9588031768798828,
        -0.04178405553102493,
        -0.09976109117269516,
        -1.1920928244535389e-07,
        -0.9238177537918091,
        -0.41008245944976807,
        -1.2076313495635986,
        -0.07528290897607803,
        -0.06271043419837952,
        -1.2434486150741577,
        -0.07616305351257324,
        -0.013455180451273918,
        -0.2760812044143677,
        -2.145764938177308e-06,
        -1.9550132492440753e-05,
        -0.23419307172298431,
        -0.009586254134774208,
        -0.00019441144831944257,
        -0.09014934301376343,
        -3.576278118089249e-07,
        -0.1981763392686844,
        -0.0003873551613651216,
        -0.1434980034828186,
        -1.0032484531402588,
        -0.615664005279541,
        -0.026531720533967018,
        -0.31120526790618896,
        -0.12931162118911743,
        -0.047340959310531616,
        -0.07430680841207504,
        -0.03033958002924919,
        -0.35857006907463074,
        -0.3552587032318115,
        -1.4185804502631072e-05,
        -0.050364259630441666,
        -0.13074587285518646,
        -0.06161314994096756,
        -0.05623753368854523,
        -1.0330641269683838,
        -3.0040289857424796e-05,
        -7.152555099310121e-07,
        -0.027283689007163048,
        -0.5707048177719116,
        -0.0054259649477899075,
        -0.09591180831193924,
        -1.0609570381348021e-05
      ],
      [
        -1.5497195136049413e-06,
        -1.1920928244535389e-07,
        -0.018192455172538757,
        -4.768370445162873e-07,
        -0.9682510495185852,
        -0.04052402079105377,
        -0.10052768886089325,
        -1.1920928244535389e-07,
        -0.939583420753479,
        -0.4147314131259918,
        -1.2175766229629517,
        -0.075166255235672,
        -0.06089901924133301,
        -1.2387117147445679,
        -0.07527085393667221,
        -0.013429304584860802,
        -0.27798131108283997,
        -2.0265558760002023e-06,
        -1.9550132492440753e-05,
        -0.23094555735588074,
        -0.009309454821050167,
        -0.00019739109848160297,
        -0.09013649076223373,
        -2.3841855067985307e-07,
        -0.19781753420829773,
        -0.0003943857445847243,
        -0.14553320407867432,
        -1.0009187459945679,
        -0.6208120584487915,
        -0.02574142999947071,
        -0.3176420032978058,
        -0.12574000656604767,
        -0.04761913791298866,
        -0.07210111618041992,
        -0.030726343393325806,
        -0.3629106283187866,
        -0.3552725911140442,
        -1.4185804502631072e-05,
        -0.04924437403678894,
        -0.1327890157699585,
        -0.061599139124155045,
        -0.05743404105305672,
        -1.0310938358306885,
        -2.8609820219571702e-05,
        -7.152555099310121e-07,
        -0.027669664472341537,
        -0.5774320960044861,
        -0.005572143942117691,
        -0.09735136479139328,
        -1.0371154530730564e-05
      ],
      [
        -1.5497195136049413e-06,
        -1.1920928244535389e-07,
        -0.018187537789344788,
        -5.960462772236497e-07,
        -0.9685234427452087,
        -0.0411471426486969,
        -0.10007835179567337,
        -1.1920928244535389e-07,
        -0.9284999966621399,
        -0.40946054458618164,
        -1.2168419361114502,
        -0.07595093548297882,
        -0.061888281255960464,
        -1.2373408079147339,
        -0.07718843221664429,
        -0.01343565620481968,
        -0.27704891562461853,
        -2.0265558760002023e-06,
        -1.9550132492440753e-05,
        -0.23449333012104034,
        -0.009589914232492447,
        -0.00019739109848160297,
        -0.09108681231737137,
        -2.3841855067985307e-07,
        -0.19965560734272003,
        -0.00040522945346310735,
        -0.14342188835144043,
        -0.9921361207962036,
        -0.6210508346557617,
        -0.025717148557305336,
        -0.31120526790618896,
        -0.1258893758058548,
        -0.047854624688625336,
        -0.07430659234523773,
        -0.030354266986250877,
        -0.3633079528808594,
        -0.3585250973701477,
        -1.4424220353248529e-05,
        -0.05036119744181633,
        -0.13091185688972473,
        -0.060698557645082474,
        -0.056232351809740067,
        -1.0330533981323242,
        -2.90866428258596e-05,
        -7.152555099310121e-07,
        -0.027272088453173637,
        -0.5706896185874939,
        -0.005427861586213112,
        -0.09734909236431122,
        -1.0371154530730564e-05
      ]
    ]
  },
  "kernels": {
    "profiling_succeeded": true,
    "all_kernels": [],
    "marlin_kernels": [],
    "gemm_kernels": [],
    "dequant_kernels": []
  },
  "verdict": {
    "is_deterministic": false,
    "deterministic_mode_tested": true,
    "summary": "BASELINE IS NON-DETERMINISTIC",
    "root_cause": "Non-determinism NOT from parallel reduction races, likely in quantization/dequantization logic",
    "forensic_implications": "Noise level: ~2.97e-02 L2. For detection, need systematic deviation >> noise. Recommend: 3-5 samples for statistical significance",
    "details": [
      "Mean L2 deviation: 2.969496e-02",
      "Max L2 deviation: 3.109406e-02",
      "\u274c DETERMINISTIC MODE DOESN'T HELP"
    ]
  },
  "success": true
}