{
  "variant": "gptq_marlin",
  "experiment": "quantization_nondeterminism_investigation",
  "timestamp": "2025-11-12T16:01:41.291220",
  "model": "JunHowie/Qwen3-8B-GPTQ-Int4",
  "quantization": "gptq_marlin",
  "description": "GPTQ INT4 with Marlin kernel",
  "config": {
    "tensor_parallel": 1,
    "max_model_len": 8192,
    "max_tokens": 50,
    "repetitions": 5,
    "temperature": 0.0,
    "seed": 42
  },
  "prompt_length": 3790,
  "baseline": {
    "stats": {
      "tokens_identical": true,
      "logprobs_exact": true,
      "l2_mean": 0.0,
      "l2_std": 0.0,
      "l2_max": 0.0,
      "l2_min": 0.0,
      "std_per_token_mean": 0.0,
      "std_per_token_max": 0.0,
      "std_per_token_min": 0.0
    },
    "tokens": [
      [
        151667,
        198,
        32313,
        11,
        773,
        358,
        1184,
        311,
        3270,
        264,
        12126,
        315,
        419,
        1293,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        5290,
        1526,
        279,
        16800,
        311,
        633,
        279,
        1887,
        3501,
        13,
        576,
        2197,
        13433,
        911,
        279,
        10916,
        40482,
        315,
        444,
        10994,
        82,
        11,
        1075,
        279,
        42578,
        17646
      ],
      [
        151667,
        198,
        32313,
        11,
        773,
        358,
        1184,
        311,
        3270,
        264,
        12126,
        315,
        419,
        1293,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        5290,
        1526,
        279,
        16800,
        311,
        633,
        279,
        1887,
        3501,
        13,
        576,
        2197,
        13433,
        911,
        279,
        10916,
        40482,
        315,
        444,
        10994,
        82,
        11,
        1075,
        279,
        42578,
        17646
      ],
      [
        151667,
        198,
        32313,
        11,
        773,
        358,
        1184,
        311,
        3270,
        264,
        12126,
        315,
        419,
        1293,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        5290,
        1526,
        279,
        16800,
        311,
        633,
        279,
        1887,
        3501,
        13,
        576,
        2197,
        13433,
        911,
        279,
        10916,
        40482,
        315,
        444,
        10994,
        82,
        11,
        1075,
        279,
        42578,
        17646
      ],
      [
        151667,
        198,
        32313,
        11,
        773,
        358,
        1184,
        311,
        3270,
        264,
        12126,
        315,
        419,
        1293,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        5290,
        1526,
        279,
        16800,
        311,
        633,
        279,
        1887,
        3501,
        13,
        576,
        2197,
        13433,
        911,
        279,
        10916,
        40482,
        315,
        444,
        10994,
        82,
        11,
        1075,
        279,
        42578,
        17646
      ],
      [
        151667,
        198,
        32313,
        11,
        773,
        358,
        1184,
        311,
        3270,
        264,
        12126,
        315,
        419,
        1293,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        5290,
        1526,
        279,
        16800,
        311,
        633,
        279,
        1887,
        3501,
        13,
        576,
        2197,
        13433,
        911,
        279,
        10916,
        40482,
        315,
        444,
        10994,
        82,
        11,
        1075,
        279,
        42578,
        17646
      ]
    ],
    "logprobs": [
      [
        -1.6689286894688848e-06,
        -1.1920928244535389e-07,
        -0.018501445651054382,
        -5.960462772236497e-07,
        -0.9650009870529175,
        -0.041153665632009506,
        -0.1012267917394638,
        -1.1920928244535389e-07,
        -0.9324464797973633,
        -0.4107561409473419,
        -1.2223936319351196,
        -0.07589789479970932,
        -0.06189209222793579,
        -1.2400448322296143,
        -0.0760941207408905,
        -0.013300973922014236,
        -0.27893978357315063,
        -2.145764938177308e-06,
        -2.1457441107486375e-05,
        -0.2347985953092575,
        -0.009347483515739441,
        -0.00019739109848160297,
        -0.09172903746366501,
        -3.576278118089249e-07,
        -0.20341242849826813,
        -0.00040058218291960657,
        -0.14348675310611725,
        -1.0157572031021118,
        -0.6261314153671265,
        -0.026547973975539207,
        -0.3196587860584259,
        -0.1259920746088028,
        -0.04657161608338356,
        -0.07210111618041992,
        -0.029947923496365547,
        -0.36328306794166565,
        -0.3600817918777466,
        -1.4662635294371285e-05,
        -0.050728511065244675,
        -0.13097868859767914,
        -0.061607543379068375,
        -0.05795289948582649,
        -1.0577598810195923,
        -2.90866428258596e-05,
        -8.344646857949556e-07,
        -0.02726721577346325,
        -0.5891403555870056,
        -0.0054441047832369804,
        -0.09735146909952164,
        -1.0609570381348021e-05
      ],
      [
        -1.6689286894688848e-06,
        -1.1920928244535389e-07,
        -0.018501445651054382,
        -5.960462772236497e-07,
        -0.9650009870529175,
        -0.041153665632009506,
        -0.1012267917394638,
        -1.1920928244535389e-07,
        -0.9324464797973633,
        -0.4107561409473419,
        -1.2223936319351196,
        -0.07589789479970932,
        -0.06189209222793579,
        -1.2400448322296143,
        -0.0760941207408905,
        -0.013300973922014236,
        -0.27893978357315063,
        -2.145764938177308e-06,
        -2.1457441107486375e-05,
        -0.2347985953092575,
        -0.009347483515739441,
        -0.00019739109848160297,
        -0.09172903746366501,
        -3.576278118089249e-07,
        -0.20341242849826813,
        -0.00040058218291960657,
        -0.14348675310611725,
        -1.0157572031021118,
        -0.6261314153671265,
        -0.026547973975539207,
        -0.3196587860584259,
        -0.1259920746088028,
        -0.04657161608338356,
        -0.07210111618041992,
        -0.029947923496365547,
        -0.36328306794166565,
        -0.3600817918777466,
        -1.4662635294371285e-05,
        -0.050728511065244675,
        -0.13097868859767914,
        -0.061607543379068375,
        -0.05795289948582649,
        -1.0577598810195923,
        -2.90866428258596e-05,
        -8.344646857949556e-07,
        -0.02726721577346325,
        -0.5891403555870056,
        -0.0054441047832369804,
        -0.09735146909952164,
        -1.0609570381348021e-05
      ],
      [
        -1.6689286894688848e-06,
        -1.1920928244535389e-07,
        -0.018501445651054382,
        -5.960462772236497e-07,
        -0.9650009870529175,
        -0.041153665632009506,
        -0.1012267917394638,
        -1.1920928244535389e-07,
        -0.9324464797973633,
        -0.4107561409473419,
        -1.2223936319351196,
        -0.07589789479970932,
        -0.06189209222793579,
        -1.2400448322296143,
        -0.0760941207408905,
        -0.013300973922014236,
        -0.27893978357315063,
        -2.145764938177308e-06,
        -2.1457441107486375e-05,
        -0.2347985953092575,
        -0.009347483515739441,
        -0.00019739109848160297,
        -0.09172903746366501,
        -3.576278118089249e-07,
        -0.20341242849826813,
        -0.00040058218291960657,
        -0.14348675310611725,
        -1.0157572031021118,
        -0.6261314153671265,
        -0.026547973975539207,
        -0.3196587860584259,
        -0.1259920746088028,
        -0.04657161608338356,
        -0.07210111618041992,
        -0.029947923496365547,
        -0.36328306794166565,
        -0.3600817918777466,
        -1.4662635294371285e-05,
        -0.050728511065244675,
        -0.13097868859767914,
        -0.061607543379068375,
        -0.05795289948582649,
        -1.0577598810195923,
        -2.90866428258596e-05,
        -8.344646857949556e-07,
        -0.02726721577346325,
        -0.5891403555870056,
        -0.0054441047832369804,
        -0.09735146909952164,
        -1.0609570381348021e-05
      ],
      [
        -1.6689286894688848e-06,
        -1.1920928244535389e-07,
        -0.018501445651054382,
        -5.960462772236497e-07,
        -0.9650009870529175,
        -0.041153665632009506,
        -0.1012267917394638,
        -1.1920928244535389e-07,
        -0.9324464797973633,
        -0.4107561409473419,
        -1.2223936319351196,
        -0.07589789479970932,
        -0.06189209222793579,
        -1.2400448322296143,
        -0.0760941207408905,
        -0.013300973922014236,
        -0.27893978357315063,
        -2.145764938177308e-06,
        -2.1457441107486375e-05,
        -0.2347985953092575,
        -0.009347483515739441,
        -0.00019739109848160297,
        -0.09172903746366501,
        -3.576278118089249e-07,
        -0.20341242849826813,
        -0.00040058218291960657,
        -0.14348675310611725,
        -1.0157572031021118,
        -0.6261314153671265,
        -0.026547973975539207,
        -0.3196587860584259,
        -0.1259920746088028,
        -0.04657161608338356,
        -0.07210111618041992,
        -0.029947923496365547,
        -0.36328306794166565,
        -0.3600817918777466,
        -1.4662635294371285e-05,
        -0.050728511065244675,
        -0.13097868859767914,
        -0.061607543379068375,
        -0.05795289948582649,
        -1.0577598810195923,
        -2.90866428258596e-05,
        -8.344646857949556e-07,
        -0.02726721577346325,
        -0.5891403555870056,
        -0.0054441047832369804,
        -0.09735146909952164,
        -1.0609570381348021e-05
      ],
      [
        -1.6689286894688848e-06,
        -1.1920928244535389e-07,
        -0.018501445651054382,
        -5.960462772236497e-07,
        -0.9650009870529175,
        -0.041153665632009506,
        -0.1012267917394638,
        -1.1920928244535389e-07,
        -0.9324464797973633,
        -0.4107561409473419,
        -1.2223936319351196,
        -0.07589789479970932,
        -0.06189209222793579,
        -1.2400448322296143,
        -0.0760941207408905,
        -0.013300973922014236,
        -0.27893978357315063,
        -2.145764938177308e-06,
        -2.1457441107486375e-05,
        -0.2347985953092575,
        -0.009347483515739441,
        -0.00019739109848160297,
        -0.09172903746366501,
        -3.576278118089249e-07,
        -0.20341242849826813,
        -0.00040058218291960657,
        -0.14348675310611725,
        -1.0157572031021118,
        -0.6261314153671265,
        -0.026547973975539207,
        -0.3196587860584259,
        -0.1259920746088028,
        -0.04657161608338356,
        -0.07210111618041992,
        -0.029947923496365547,
        -0.36328306794166565,
        -0.3600817918777466,
        -1.4662635294371285e-05,
        -0.050728511065244675,
        -0.13097868859767914,
        -0.061607543379068375,
        -0.05795289948582649,
        -1.0577598810195923,
        -2.90866428258596e-05,
        -8.344646857949556e-07,
        -0.02726721577346325,
        -0.5891403555870056,
        -0.0054441047832369804,
        -0.09735146909952164,
        -1.0609570381348021e-05
      ]
    ]
  },
  "deterministic": {
    "succeeded": true,
    "stats": {
      "tokens_identical": true,
      "logprobs_exact": true,
      "l2_mean": 0.0,
      "l2_std": 0.0,
      "l2_max": 0.0,
      "l2_min": 0.0,
      "std_per_token_mean": 0.0,
      "std_per_token_max": 0.0,
      "std_per_token_min": 0.0
    },
    "tokens": [
      [
        151667,
        198,
        32313,
        11,
        773,
        358,
        1184,
        311,
        3270,
        264,
        12126,
        315,
        419,
        1293,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        5290,
        1526,
        279,
        16800,
        311,
        633,
        279,
        1887,
        3501,
        13,
        576,
        2197,
        13433,
        911,
        279,
        10916,
        40482,
        315,
        444,
        10994,
        82,
        11,
        1075,
        279,
        42578,
        17646
      ],
      [
        151667,
        198,
        32313,
        11,
        773,
        358,
        1184,
        311,
        3270,
        264,
        12126,
        315,
        419,
        1293,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        5290,
        1526,
        279,
        16800,
        311,
        633,
        279,
        1887,
        3501,
        13,
        576,
        2197,
        13433,
        911,
        279,
        10916,
        40482,
        315,
        444,
        10994,
        82,
        11,
        1075,
        279,
        42578,
        17646
      ],
      [
        151667,
        198,
        32313,
        11,
        773,
        358,
        1184,
        311,
        3270,
        264,
        12126,
        315,
        419,
        1293,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        5290,
        1526,
        279,
        16800,
        311,
        633,
        279,
        1887,
        3501,
        13,
        576,
        2197,
        13433,
        911,
        279,
        10916,
        40482,
        315,
        444,
        10994,
        82,
        11,
        1075,
        279,
        42578,
        17646
      ],
      [
        151667,
        198,
        32313,
        11,
        773,
        358,
        1184,
        311,
        3270,
        264,
        12126,
        315,
        419,
        1293,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        5290,
        1526,
        279,
        16800,
        311,
        633,
        279,
        1887,
        3501,
        13,
        576,
        2197,
        13433,
        911,
        279,
        10916,
        40482,
        315,
        444,
        10994,
        82,
        11,
        1075,
        279,
        42578,
        17646
      ],
      [
        151667,
        198,
        32313,
        11,
        773,
        358,
        1184,
        311,
        3270,
        264,
        12126,
        315,
        419,
        1293,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        5290,
        1526,
        279,
        16800,
        311,
        633,
        279,
        1887,
        3501,
        13,
        576,
        2197,
        13433,
        911,
        279,
        10916,
        40482,
        315,
        444,
        10994,
        82,
        11,
        1075,
        279,
        42578,
        17646
      ]
    ],
    "logprobs": [
      [
        -1.6689286894688848e-06,
        -1.1920928244535389e-07,
        -0.018501445651054382,
        -5.960462772236497e-07,
        -0.9650009870529175,
        -0.041153665632009506,
        -0.1012267917394638,
        -1.1920928244535389e-07,
        -0.9324464797973633,
        -0.4107561409473419,
        -1.2223936319351196,
        -0.07589789479970932,
        -0.06189209222793579,
        -1.2400448322296143,
        -0.0760941207408905,
        -0.013300973922014236,
        -0.27893978357315063,
        -2.145764938177308e-06,
        -2.1457441107486375e-05,
        -0.2347985953092575,
        -0.009347483515739441,
        -0.00019739109848160297,
        -0.09172903746366501,
        -3.576278118089249e-07,
        -0.20341242849826813,
        -0.00040058218291960657,
        -0.14348675310611725,
        -1.0157572031021118,
        -0.6261314153671265,
        -0.026547973975539207,
        -0.3196587860584259,
        -0.1259920746088028,
        -0.04657161608338356,
        -0.07210111618041992,
        -0.029947923496365547,
        -0.36328306794166565,
        -0.3600817918777466,
        -1.4662635294371285e-05,
        -0.050728511065244675,
        -0.13097868859767914,
        -0.061607543379068375,
        -0.05795289948582649,
        -1.0577598810195923,
        -2.90866428258596e-05,
        -8.344646857949556e-07,
        -0.02726721577346325,
        -0.5891403555870056,
        -0.0054441047832369804,
        -0.09735146909952164,
        -1.0609570381348021e-05
      ],
      [
        -1.6689286894688848e-06,
        -1.1920928244535389e-07,
        -0.018501445651054382,
        -5.960462772236497e-07,
        -0.9650009870529175,
        -0.041153665632009506,
        -0.1012267917394638,
        -1.1920928244535389e-07,
        -0.9324464797973633,
        -0.4107561409473419,
        -1.2223936319351196,
        -0.07589789479970932,
        -0.06189209222793579,
        -1.2400448322296143,
        -0.0760941207408905,
        -0.013300973922014236,
        -0.27893978357315063,
        -2.145764938177308e-06,
        -2.1457441107486375e-05,
        -0.2347985953092575,
        -0.009347483515739441,
        -0.00019739109848160297,
        -0.09172903746366501,
        -3.576278118089249e-07,
        -0.20341242849826813,
        -0.00040058218291960657,
        -0.14348675310611725,
        -1.0157572031021118,
        -0.6261314153671265,
        -0.026547973975539207,
        -0.3196587860584259,
        -0.1259920746088028,
        -0.04657161608338356,
        -0.07210111618041992,
        -0.029947923496365547,
        -0.36328306794166565,
        -0.3600817918777466,
        -1.4662635294371285e-05,
        -0.050728511065244675,
        -0.13097868859767914,
        -0.061607543379068375,
        -0.05795289948582649,
        -1.0577598810195923,
        -2.90866428258596e-05,
        -8.344646857949556e-07,
        -0.02726721577346325,
        -0.5891403555870056,
        -0.0054441047832369804,
        -0.09735146909952164,
        -1.0609570381348021e-05
      ],
      [
        -1.6689286894688848e-06,
        -1.1920928244535389e-07,
        -0.018501445651054382,
        -5.960462772236497e-07,
        -0.9650009870529175,
        -0.041153665632009506,
        -0.1012267917394638,
        -1.1920928244535389e-07,
        -0.9324464797973633,
        -0.4107561409473419,
        -1.2223936319351196,
        -0.07589789479970932,
        -0.06189209222793579,
        -1.2400448322296143,
        -0.0760941207408905,
        -0.013300973922014236,
        -0.27893978357315063,
        -2.145764938177308e-06,
        -2.1457441107486375e-05,
        -0.2347985953092575,
        -0.009347483515739441,
        -0.00019739109848160297,
        -0.09172903746366501,
        -3.576278118089249e-07,
        -0.20341242849826813,
        -0.00040058218291960657,
        -0.14348675310611725,
        -1.0157572031021118,
        -0.6261314153671265,
        -0.026547973975539207,
        -0.3196587860584259,
        -0.1259920746088028,
        -0.04657161608338356,
        -0.07210111618041992,
        -0.029947923496365547,
        -0.36328306794166565,
        -0.3600817918777466,
        -1.4662635294371285e-05,
        -0.050728511065244675,
        -0.13097868859767914,
        -0.061607543379068375,
        -0.05795289948582649,
        -1.0577598810195923,
        -2.90866428258596e-05,
        -8.344646857949556e-07,
        -0.02726721577346325,
        -0.5891403555870056,
        -0.0054441047832369804,
        -0.09735146909952164,
        -1.0609570381348021e-05
      ],
      [
        -1.6689286894688848e-06,
        -1.1920928244535389e-07,
        -0.018501445651054382,
        -5.960462772236497e-07,
        -0.9650009870529175,
        -0.041153665632009506,
        -0.1012267917394638,
        -1.1920928244535389e-07,
        -0.9324464797973633,
        -0.4107561409473419,
        -1.2223936319351196,
        -0.07589789479970932,
        -0.06189209222793579,
        -1.2400448322296143,
        -0.0760941207408905,
        -0.013300973922014236,
        -0.27893978357315063,
        -2.145764938177308e-06,
        -2.1457441107486375e-05,
        -0.2347985953092575,
        -0.009347483515739441,
        -0.00019739109848160297,
        -0.09172903746366501,
        -3.576278118089249e-07,
        -0.20341242849826813,
        -0.00040058218291960657,
        -0.14348675310611725,
        -1.0157572031021118,
        -0.6261314153671265,
        -0.026547973975539207,
        -0.3196587860584259,
        -0.1259920746088028,
        -0.04657161608338356,
        -0.07210111618041992,
        -0.029947923496365547,
        -0.36328306794166565,
        -0.3600817918777466,
        -1.4662635294371285e-05,
        -0.050728511065244675,
        -0.13097868859767914,
        -0.061607543379068375,
        -0.05795289948582649,
        -1.0577598810195923,
        -2.90866428258596e-05,
        -8.344646857949556e-07,
        -0.02726721577346325,
        -0.5891403555870056,
        -0.0054441047832369804,
        -0.09735146909952164,
        -1.0609570381348021e-05
      ],
      [
        -1.6689286894688848e-06,
        -1.1920928244535389e-07,
        -0.018501445651054382,
        -5.960462772236497e-07,
        -0.9650009870529175,
        -0.041153665632009506,
        -0.1012267917394638,
        -1.1920928244535389e-07,
        -0.9324464797973633,
        -0.4107561409473419,
        -1.2223936319351196,
        -0.07589789479970932,
        -0.06189209222793579,
        -1.2400448322296143,
        -0.0760941207408905,
        -0.013300973922014236,
        -0.27893978357315063,
        -2.145764938177308e-06,
        -2.1457441107486375e-05,
        -0.2347985953092575,
        -0.009347483515739441,
        -0.00019739109848160297,
        -0.09172903746366501,
        -3.576278118089249e-07,
        -0.20341242849826813,
        -0.00040058218291960657,
        -0.14348675310611725,
        -1.0157572031021118,
        -0.6261314153671265,
        -0.026547973975539207,
        -0.3196587860584259,
        -0.1259920746088028,
        -0.04657161608338356,
        -0.07210111618041992,
        -0.029947923496365547,
        -0.36328306794166565,
        -0.3600817918777466,
        -1.4662635294371285e-05,
        -0.050728511065244675,
        -0.13097868859767914,
        -0.061607543379068375,
        -0.05795289948582649,
        -1.0577598810195923,
        -2.90866428258596e-05,
        -8.344646857949556e-07,
        -0.02726721577346325,
        -0.5891403555870056,
        -0.0054441047832369804,
        -0.09735146909952164,
        -1.0609570381348021e-05
      ]
    ]
  },
  "kernels": {
    "profiling_succeeded": true,
    "all_kernels": [],
    "marlin_kernels": [],
    "gemm_kernels": [],
    "dequant_kernels": []
  },
  "verdict": {
    "is_deterministic": true,
    "deterministic_mode_tested": true,
    "summary": "BASELINE IS DETERMINISTIC",
    "root_cause": "Fully deterministic behavior",
    "forensic_implications": "Perfect reproducibility - any deviation indicates computational change",
    "details": [
      "Unexpected for gptq_marlin! May have been fixed in recent vLLM version"
    ]
  },
  "success": true
}