{
  "variant": "pytorch_int4",
  "experiment": "quantization_nondeterminism_investigation",
  "timestamp": "2025-11-12T16:21:07.263617",
  "model": "pytorch/Qwen3-8B-INT4",
  "quantization": "torchao",
  "description": "PyTorch TorchAO INT4 (HQQ algorithm)",
  "config": {
    "tensor_parallel": 1,
    "max_model_len": 8192,
    "max_tokens": 50,
    "repetitions": 5,
    "temperature": 0.0,
    "seed": 42
  },
  "prompt_length": 3790,
  "baseline": {
    "stats": {
      "tokens_identical": true,
      "logprobs_exact": true,
      "l2_mean": 0.0,
      "l2_std": 0.0,
      "l2_max": 0.0,
      "l2_min": 0.0,
      "std_per_token_mean": 0.0,
      "std_per_token_max": 0.0,
      "std_per_token_min": 0.0
    },
    "tokens": [
      [
        151667,
        198,
        32313,
        11,
        358,
        1184,
        311,
        1492,
        279,
        1196,
        553,
        8241,
        264,
        11682,
        6358,
        315,
        279,
        2661,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        8660,
        279,
        5944,
        315,
        279,
        2197,
        13,
        1084,
        594,
        17779,
        1119,
        8094,
        5479,
        11,
        1817,
        18202,
        2155,
        13566,
        1075,
        17646,
        11,
        54480
      ],
      [
        151667,
        198,
        32313,
        11,
        358,
        1184,
        311,
        1492,
        279,
        1196,
        553,
        8241,
        264,
        11682,
        6358,
        315,
        279,
        2661,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        8660,
        279,
        5944,
        315,
        279,
        2197,
        13,
        1084,
        594,
        17779,
        1119,
        8094,
        5479,
        11,
        1817,
        18202,
        2155,
        13566,
        1075,
        17646,
        11,
        54480
      ],
      [
        151667,
        198,
        32313,
        11,
        358,
        1184,
        311,
        1492,
        279,
        1196,
        553,
        8241,
        264,
        11682,
        6358,
        315,
        279,
        2661,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        8660,
        279,
        5944,
        315,
        279,
        2197,
        13,
        1084,
        594,
        17779,
        1119,
        8094,
        5479,
        11,
        1817,
        18202,
        2155,
        13566,
        1075,
        17646,
        11,
        54480
      ],
      [
        151667,
        198,
        32313,
        11,
        358,
        1184,
        311,
        1492,
        279,
        1196,
        553,
        8241,
        264,
        11682,
        6358,
        315,
        279,
        2661,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        8660,
        279,
        5944,
        315,
        279,
        2197,
        13,
        1084,
        594,
        17779,
        1119,
        8094,
        5479,
        11,
        1817,
        18202,
        2155,
        13566,
        1075,
        17646,
        11,
        54480
      ],
      [
        151667,
        198,
        32313,
        11,
        358,
        1184,
        311,
        1492,
        279,
        1196,
        553,
        8241,
        264,
        11682,
        6358,
        315,
        279,
        2661,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        8660,
        279,
        5944,
        315,
        279,
        2197,
        13,
        1084,
        594,
        17779,
        1119,
        8094,
        5479,
        11,
        1817,
        18202,
        2155,
        13566,
        1075,
        17646,
        11,
        54480
      ]
    ],
    "logprobs": [
      [
        -4.768370445162873e-07,
        -1.2993727978027891e-05,
        -0.00512381736189127,
        -1.311301275563892e-06,
        -0.6976582407951355,
        -0.013921890407800674,
        -1.0728830375228426e-06,
        -1.513399362564087,
        -0.0319368913769722,
        -0.0004924515378661454,
        -0.5258370041847229,
        -1.394982099533081,
        -0.12338214367628098,
        -0.6868460178375244,
        -1.1835774183273315,
        -0.10319152474403381,
        -0.16109135746955872,
        -0.8272461891174316,
        -0.4149714708328247,
        -0.7101094126701355,
        -0.5709152817726135,
        -1.1324817933200393e-05,
        -0.0009124883217737079,
        -0.43959513306617737,
        -0.4499320983886719,
        -0.01815534569323063,
        -0.0229615680873394,
        -1.1920928244535389e-07,
        -0.24438853561878204,
        -0.2014683037996292,
        -0.35847344994544983,
        -0.7332577705383301,
        -0.0011866202112287283,
        -0.019614310935139656,
        -0.028966834768652916,
        -0.06895133852958679,
        -0.03458266705274582,
        -0.005190942902117968,
        -1.1920928244535389e-07,
        -0.10940465331077576,
        -0.25876691937446594,
        -0.6856079697608948,
        -0.28955110907554626,
        -0.41456612944602966,
        -0.052382417023181915,
        -0.089697927236557,
        -0.514742374420166,
        -0.16728822886943817,
        -7.390703103737906e-05,
        -0.020823780447244644
      ],
      [
        -4.768370445162873e-07,
        -1.2993727978027891e-05,
        -0.00512381736189127,
        -1.311301275563892e-06,
        -0.6976582407951355,
        -0.013921890407800674,
        -1.0728830375228426e-06,
        -1.513399362564087,
        -0.0319368913769722,
        -0.0004924515378661454,
        -0.5258370041847229,
        -1.394982099533081,
        -0.12338214367628098,
        -0.6868460178375244,
        -1.1835774183273315,
        -0.10319152474403381,
        -0.16109135746955872,
        -0.8272461891174316,
        -0.4149714708328247,
        -0.7101094126701355,
        -0.5709152817726135,
        -1.1324817933200393e-05,
        -0.0009124883217737079,
        -0.43959513306617737,
        -0.4499320983886719,
        -0.01815534569323063,
        -0.0229615680873394,
        -1.1920928244535389e-07,
        -0.24438853561878204,
        -0.2014683037996292,
        -0.35847344994544983,
        -0.7332577705383301,
        -0.0011866202112287283,
        -0.019614310935139656,
        -0.028966834768652916,
        -0.06895133852958679,
        -0.03458266705274582,
        -0.005190942902117968,
        -1.1920928244535389e-07,
        -0.10940465331077576,
        -0.25876691937446594,
        -0.6856079697608948,
        -0.28955110907554626,
        -0.41456612944602966,
        -0.052382417023181915,
        -0.089697927236557,
        -0.514742374420166,
        -0.16728822886943817,
        -7.390703103737906e-05,
        -0.020823780447244644
      ],
      [
        -4.768370445162873e-07,
        -1.2993727978027891e-05,
        -0.00512381736189127,
        -1.311301275563892e-06,
        -0.6976582407951355,
        -0.013921890407800674,
        -1.0728830375228426e-06,
        -1.513399362564087,
        -0.0319368913769722,
        -0.0004924515378661454,
        -0.5258370041847229,
        -1.394982099533081,
        -0.12338214367628098,
        -0.6868460178375244,
        -1.1835774183273315,
        -0.10319152474403381,
        -0.16109135746955872,
        -0.8272461891174316,
        -0.4149714708328247,
        -0.7101094126701355,
        -0.5709152817726135,
        -1.1324817933200393e-05,
        -0.0009124883217737079,
        -0.43959513306617737,
        -0.4499320983886719,
        -0.01815534569323063,
        -0.0229615680873394,
        -1.1920928244535389e-07,
        -0.24438853561878204,
        -0.2014683037996292,
        -0.35847344994544983,
        -0.7332577705383301,
        -0.0011866202112287283,
        -0.019614310935139656,
        -0.028966834768652916,
        -0.06895133852958679,
        -0.03458266705274582,
        -0.005190942902117968,
        -1.1920928244535389e-07,
        -0.10940465331077576,
        -0.25876691937446594,
        -0.6856079697608948,
        -0.28955110907554626,
        -0.41456612944602966,
        -0.052382417023181915,
        -0.089697927236557,
        -0.514742374420166,
        -0.16728822886943817,
        -7.390703103737906e-05,
        -0.020823780447244644
      ],
      [
        -4.768370445162873e-07,
        -1.2993727978027891e-05,
        -0.00512381736189127,
        -1.311301275563892e-06,
        -0.6976582407951355,
        -0.013921890407800674,
        -1.0728830375228426e-06,
        -1.513399362564087,
        -0.0319368913769722,
        -0.0004924515378661454,
        -0.5258370041847229,
        -1.394982099533081,
        -0.12338214367628098,
        -0.6868460178375244,
        -1.1835774183273315,
        -0.10319152474403381,
        -0.16109135746955872,
        -0.8272461891174316,
        -0.4149714708328247,
        -0.7101094126701355,
        -0.5709152817726135,
        -1.1324817933200393e-05,
        -0.0009124883217737079,
        -0.43959513306617737,
        -0.4499320983886719,
        -0.01815534569323063,
        -0.0229615680873394,
        -1.1920928244535389e-07,
        -0.24438853561878204,
        -0.2014683037996292,
        -0.35847344994544983,
        -0.7332577705383301,
        -0.0011866202112287283,
        -0.019614310935139656,
        -0.028966834768652916,
        -0.06895133852958679,
        -0.03458266705274582,
        -0.005190942902117968,
        -1.1920928244535389e-07,
        -0.10940465331077576,
        -0.25876691937446594,
        -0.6856079697608948,
        -0.28955110907554626,
        -0.41456612944602966,
        -0.052382417023181915,
        -0.089697927236557,
        -0.514742374420166,
        -0.16728822886943817,
        -7.390703103737906e-05,
        -0.020823780447244644
      ],
      [
        -4.768370445162873e-07,
        -1.2993727978027891e-05,
        -0.00512381736189127,
        -1.311301275563892e-06,
        -0.6976582407951355,
        -0.013921890407800674,
        -1.0728830375228426e-06,
        -1.513399362564087,
        -0.0319368913769722,
        -0.0004924515378661454,
        -0.5258370041847229,
        -1.394982099533081,
        -0.12338214367628098,
        -0.6868460178375244,
        -1.1835774183273315,
        -0.10319152474403381,
        -0.16109135746955872,
        -0.8272461891174316,
        -0.4149714708328247,
        -0.7101094126701355,
        -0.5709152817726135,
        -1.1324817933200393e-05,
        -0.0009124883217737079,
        -0.43959513306617737,
        -0.4499320983886719,
        -0.01815534569323063,
        -0.0229615680873394,
        -1.1920928244535389e-07,
        -0.24438853561878204,
        -0.2014683037996292,
        -0.35847344994544983,
        -0.7332577705383301,
        -0.0011866202112287283,
        -0.019614310935139656,
        -0.028966834768652916,
        -0.06895133852958679,
        -0.03458266705274582,
        -0.005190942902117968,
        -1.1920928244535389e-07,
        -0.10940465331077576,
        -0.25876691937446594,
        -0.6856079697608948,
        -0.28955110907554626,
        -0.41456612944602966,
        -0.052382417023181915,
        -0.089697927236557,
        -0.514742374420166,
        -0.16728822886943817,
        -7.390703103737906e-05,
        -0.020823780447244644
      ]
    ]
  },
  "deterministic": {
    "succeeded": true,
    "stats": {
      "tokens_identical": true,
      "logprobs_exact": true,
      "l2_mean": 0.0,
      "l2_std": 0.0,
      "l2_max": 0.0,
      "l2_min": 0.0,
      "std_per_token_mean": 0.0,
      "std_per_token_max": 0.0,
      "std_per_token_min": 0.0
    },
    "tokens": [
      [
        151667,
        198,
        32313,
        11,
        358,
        1184,
        311,
        1492,
        279,
        1196,
        553,
        8241,
        264,
        11682,
        6358,
        315,
        279,
        2661,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        8660,
        279,
        5944,
        315,
        279,
        2197,
        13,
        1084,
        594,
        17779,
        1119,
        8094,
        5479,
        11,
        1817,
        18202,
        2155,
        13566,
        1075,
        17646,
        11,
        54480
      ],
      [
        151667,
        198,
        32313,
        11,
        358,
        1184,
        311,
        1492,
        279,
        1196,
        553,
        8241,
        264,
        11682,
        6358,
        315,
        279,
        2661,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        8660,
        279,
        5944,
        315,
        279,
        2197,
        13,
        1084,
        594,
        17779,
        1119,
        8094,
        5479,
        11,
        1817,
        18202,
        2155,
        13566,
        1075,
        17646,
        11,
        54480
      ],
      [
        151667,
        198,
        32313,
        11,
        358,
        1184,
        311,
        1492,
        279,
        1196,
        553,
        8241,
        264,
        11682,
        6358,
        315,
        279,
        2661,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        8660,
        279,
        5944,
        315,
        279,
        2197,
        13,
        1084,
        594,
        17779,
        1119,
        8094,
        5479,
        11,
        1817,
        18202,
        2155,
        13566,
        1075,
        17646,
        11,
        54480
      ],
      [
        151667,
        198,
        32313,
        11,
        358,
        1184,
        311,
        1492,
        279,
        1196,
        553,
        8241,
        264,
        11682,
        6358,
        315,
        279,
        2661,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        8660,
        279,
        5944,
        315,
        279,
        2197,
        13,
        1084,
        594,
        17779,
        1119,
        8094,
        5479,
        11,
        1817,
        18202,
        2155,
        13566,
        1075,
        17646,
        11,
        54480
      ],
      [
        151667,
        198,
        32313,
        11,
        358,
        1184,
        311,
        1492,
        279,
        1196,
        553,
        8241,
        264,
        11682,
        6358,
        315,
        279,
        2661,
        2197,
        911,
        3460,
        4128,
        4119,
        13,
        6771,
        752,
        1191,
        553,
        8660,
        279,
        5944,
        315,
        279,
        2197,
        13,
        1084,
        594,
        17779,
        1119,
        8094,
        5479,
        11,
        1817,
        18202,
        2155,
        13566,
        1075,
        17646,
        11,
        54480
      ]
    ],
    "logprobs": [
      [
        -4.768370445162873e-07,
        -1.2993727978027891e-05,
        -0.00512381736189127,
        -1.311301275563892e-06,
        -0.6976582407951355,
        -0.013921890407800674,
        -1.0728830375228426e-06,
        -1.513399362564087,
        -0.0319368913769722,
        -0.0004924515378661454,
        -0.5258370041847229,
        -1.394982099533081,
        -0.12338214367628098,
        -0.6868460178375244,
        -1.1835774183273315,
        -0.10319152474403381,
        -0.16109135746955872,
        -0.8272461891174316,
        -0.4149714708328247,
        -0.7101094126701355,
        -0.5709152817726135,
        -1.1324817933200393e-05,
        -0.0009124883217737079,
        -0.43959513306617737,
        -0.4499320983886719,
        -0.01815534569323063,
        -0.0229615680873394,
        -1.1920928244535389e-07,
        -0.24438853561878204,
        -0.2014683037996292,
        -0.35847344994544983,
        -0.7332577705383301,
        -0.0011866202112287283,
        -0.019614310935139656,
        -0.028966834768652916,
        -0.06895133852958679,
        -0.03458266705274582,
        -0.005190942902117968,
        -1.1920928244535389e-07,
        -0.10940465331077576,
        -0.25876691937446594,
        -0.6856079697608948,
        -0.28955110907554626,
        -0.41456612944602966,
        -0.052382417023181915,
        -0.089697927236557,
        -0.514742374420166,
        -0.16728822886943817,
        -7.390703103737906e-05,
        -0.020823780447244644
      ],
      [
        -4.768370445162873e-07,
        -1.2993727978027891e-05,
        -0.00512381736189127,
        -1.311301275563892e-06,
        -0.6976582407951355,
        -0.013921890407800674,
        -1.0728830375228426e-06,
        -1.513399362564087,
        -0.0319368913769722,
        -0.0004924515378661454,
        -0.5258370041847229,
        -1.394982099533081,
        -0.12338214367628098,
        -0.6868460178375244,
        -1.1835774183273315,
        -0.10319152474403381,
        -0.16109135746955872,
        -0.8272461891174316,
        -0.4149714708328247,
        -0.7101094126701355,
        -0.5709152817726135,
        -1.1324817933200393e-05,
        -0.0009124883217737079,
        -0.43959513306617737,
        -0.4499320983886719,
        -0.01815534569323063,
        -0.0229615680873394,
        -1.1920928244535389e-07,
        -0.24438853561878204,
        -0.2014683037996292,
        -0.35847344994544983,
        -0.7332577705383301,
        -0.0011866202112287283,
        -0.019614310935139656,
        -0.028966834768652916,
        -0.06895133852958679,
        -0.03458266705274582,
        -0.005190942902117968,
        -1.1920928244535389e-07,
        -0.10940465331077576,
        -0.25876691937446594,
        -0.6856079697608948,
        -0.28955110907554626,
        -0.41456612944602966,
        -0.052382417023181915,
        -0.089697927236557,
        -0.514742374420166,
        -0.16728822886943817,
        -7.390703103737906e-05,
        -0.020823780447244644
      ],
      [
        -4.768370445162873e-07,
        -1.2993727978027891e-05,
        -0.00512381736189127,
        -1.311301275563892e-06,
        -0.6976582407951355,
        -0.013921890407800674,
        -1.0728830375228426e-06,
        -1.513399362564087,
        -0.0319368913769722,
        -0.0004924515378661454,
        -0.5258370041847229,
        -1.394982099533081,
        -0.12338214367628098,
        -0.6868460178375244,
        -1.1835774183273315,
        -0.10319152474403381,
        -0.16109135746955872,
        -0.8272461891174316,
        -0.4149714708328247,
        -0.7101094126701355,
        -0.5709152817726135,
        -1.1324817933200393e-05,
        -0.0009124883217737079,
        -0.43959513306617737,
        -0.4499320983886719,
        -0.01815534569323063,
        -0.0229615680873394,
        -1.1920928244535389e-07,
        -0.24438853561878204,
        -0.2014683037996292,
        -0.35847344994544983,
        -0.7332577705383301,
        -0.0011866202112287283,
        -0.019614310935139656,
        -0.028966834768652916,
        -0.06895133852958679,
        -0.03458266705274582,
        -0.005190942902117968,
        -1.1920928244535389e-07,
        -0.10940465331077576,
        -0.25876691937446594,
        -0.6856079697608948,
        -0.28955110907554626,
        -0.41456612944602966,
        -0.052382417023181915,
        -0.089697927236557,
        -0.514742374420166,
        -0.16728822886943817,
        -7.390703103737906e-05,
        -0.020823780447244644
      ],
      [
        -4.768370445162873e-07,
        -1.2993727978027891e-05,
        -0.00512381736189127,
        -1.311301275563892e-06,
        -0.6976582407951355,
        -0.013921890407800674,
        -1.0728830375228426e-06,
        -1.513399362564087,
        -0.0319368913769722,
        -0.0004924515378661454,
        -0.5258370041847229,
        -1.394982099533081,
        -0.12338214367628098,
        -0.6868460178375244,
        -1.1835774183273315,
        -0.10319152474403381,
        -0.16109135746955872,
        -0.8272461891174316,
        -0.4149714708328247,
        -0.7101094126701355,
        -0.5709152817726135,
        -1.1324817933200393e-05,
        -0.0009124883217737079,
        -0.43959513306617737,
        -0.4499320983886719,
        -0.01815534569323063,
        -0.0229615680873394,
        -1.1920928244535389e-07,
        -0.24438853561878204,
        -0.2014683037996292,
        -0.35847344994544983,
        -0.7332577705383301,
        -0.0011866202112287283,
        -0.019614310935139656,
        -0.028966834768652916,
        -0.06895133852958679,
        -0.03458266705274582,
        -0.005190942902117968,
        -1.1920928244535389e-07,
        -0.10940465331077576,
        -0.25876691937446594,
        -0.6856079697608948,
        -0.28955110907554626,
        -0.41456612944602966,
        -0.052382417023181915,
        -0.089697927236557,
        -0.514742374420166,
        -0.16728822886943817,
        -7.390703103737906e-05,
        -0.020823780447244644
      ],
      [
        -4.768370445162873e-07,
        -1.2993727978027891e-05,
        -0.00512381736189127,
        -1.311301275563892e-06,
        -0.6976582407951355,
        -0.013921890407800674,
        -1.0728830375228426e-06,
        -1.513399362564087,
        -0.0319368913769722,
        -0.0004924515378661454,
        -0.5258370041847229,
        -1.394982099533081,
        -0.12338214367628098,
        -0.6868460178375244,
        -1.1835774183273315,
        -0.10319152474403381,
        -0.16109135746955872,
        -0.8272461891174316,
        -0.4149714708328247,
        -0.7101094126701355,
        -0.5709152817726135,
        -1.1324817933200393e-05,
        -0.0009124883217737079,
        -0.43959513306617737,
        -0.4499320983886719,
        -0.01815534569323063,
        -0.0229615680873394,
        -1.1920928244535389e-07,
        -0.24438853561878204,
        -0.2014683037996292,
        -0.35847344994544983,
        -0.7332577705383301,
        -0.0011866202112287283,
        -0.019614310935139656,
        -0.028966834768652916,
        -0.06895133852958679,
        -0.03458266705274582,
        -0.005190942902117968,
        -1.1920928244535389e-07,
        -0.10940465331077576,
        -0.25876691937446594,
        -0.6856079697608948,
        -0.28955110907554626,
        -0.41456612944602966,
        -0.052382417023181915,
        -0.089697927236557,
        -0.514742374420166,
        -0.16728822886943817,
        -7.390703103737906e-05,
        -0.020823780447244644
      ]
    ]
  },
  "kernels": {
    "profiling_succeeded": true,
    "all_kernels": [],
    "marlin_kernels": [],
    "gemm_kernels": [],
    "dequant_kernels": []
  },
  "verdict": {
    "is_deterministic": true,
    "deterministic_mode_tested": true,
    "summary": "BASELINE IS DETERMINISTIC",
    "root_cause": "Fully deterministic behavior",
    "forensic_implications": "Perfect reproducibility - any deviation indicates computational change",
    "details": [
      "Unexpected for torchao! May have been fixed in recent vLLM version"
    ]
  },
  "success": true
}