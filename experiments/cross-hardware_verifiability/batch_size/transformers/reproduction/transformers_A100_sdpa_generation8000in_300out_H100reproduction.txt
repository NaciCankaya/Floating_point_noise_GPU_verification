================================================================================
CROSS-HARDWARE BATCH SIZE DETECTABILITY - VERIFICATION (teacher-forcing)
================================================================================

System: dbb139c9b0a9
GPU: NVIDIA H100 PCIe
Attention: sdpa
Layers: [28]
Found 11 PDF(s)
  Loading: /workspace/AI_deception.pdf
  Loading: /workspace/Are_you_secretly_training_AI.pdf
  Loading: /workspace/BaGuaLu.pdf
  Loading: /workspace/Llama3.1.pdf
  Loading: /workspace/Qwen_Image.pdf
  Loading: /workspace/Verification-for-International-AI-Governance.pdf
  Loading: /workspace/k2.pdf
  Loading: /workspace/mask_is_all_you_need.pdf
  Loading: /workspace/minimax.pdf
  Loading: /workspace/situationalawareness.pdf
  Loading: /workspace/verifying training data.pdf
Total source tokens: 560575
Prompt structure: 33 prefix + 8000 snippet + 34 suffix = 8067 tokens
All 51 prompts: 8067 tokens each

Sample prompt ending:
' systematically depart from the truth.\n"\n\nBased on this excerpt, what type of document do you think this is from, and what is its likely subject matter? Explain your reasoning.<|im_end|>\n<|im_start|>assistant\n'

================================================================================
ENVIRONMENT VALIDATION
================================================================================

Script configuration:
  ✓ attn_implementation: sdpa

Container-level dependencies:
  ✓ python_version: 3.12.3
  ✓ cuda_version: 12.8
  ✓ cudnn_version: 91002

Pip-installable packages:
  ✓ torch_version: 2.8.0+cu128
  ✓ transformers_version: 4.57.3
  ✓ numpy_version: 2.1.2
  - flash_attn_version: not using flash_attention_2 (skip)

Expected differences (hardware):
  ✓ gpu_name: reference=NVIDIA A100 80GB PCIe, verifier=NVIDIA H100 PCIe
  ✓ hostname: reference=c6c6242ae438, verifier=dbb139c9b0a9

------------------------------------------------------------
✓ ENVIRONMENT VALIDATION PASSED

Loaded equivalent pairs from reference:
  Prefill: [(1, 2), (1, 3), (1, 4), (1, 5), (1, 8), (1, 9), (1, 16), (1, 17), (2, 3), (2, 4), (2, 5), (2, 8), (2, 9), (2, 16), (2, 17), (3, 4), (3, 5), (3, 8), (3, 9), (3, 16), (3, 17), (4, 5), (4, 8), (4, 9), (4, 16), (4, 17), (5, 8), (5, 9), (5, 16), (5, 17), (8, 9), (8, 16), (8, 17), (9, 16), (9, 17), (16, 17)]
  Decode: [(8, 9)]

================================================================================
REFERENCE: ref_0
================================================================================

  Claimed batch size: 1
    Verify bs=1 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=1) → 300 steps
      Key: 5.60e-01, LP: 2.16e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 5.91e-01, LP: 2.54e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 5.57e-01, LP: 1.84e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 5.50e-01, LP: 1.93e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 5.46e-01, LP: 2.02e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 5.31e-01, LP: 2.27e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 5.41e-01, LP: 1.67e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 3.03e-01, LP: 2.27e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 5.22e-01, LP: 1.67e-01

  Claimed batch size: 2
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 4.16e-01, LP: 1.70e-01
    Verify bs=2 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=2) → 300 steps
      Key: 6.51e-01, LP: 1.77e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 3.37e-01, LP: 1.72e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 3.29e-01, LP: 2.19e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 3.54e-01, LP: 1.64e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 4.34e-01, LP: 2.22e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 4.34e-01, LP: 1.61e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 3.17e-01, LP: 2.03e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 4.33e-01, LP: 1.97e-01

  Claimed batch size: 3
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 1.13e+00, LP: 1.32e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 1.18e+00, LP: 1.73e-01
    Verify bs=3 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=3) → 300 steps
      Key: 1.11e+00, LP: 1.42e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 1.12e+00, LP: 1.96e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 1.40e+00, LP: 2.01e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 1.13e+00, LP: 1.18e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 3.20e-01, LP: 1.42e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 6.06e-01, LP: 1.67e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 1.13e+00, LP: 1.90e-01

  Claimed batch size: 4
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 5.50e-01, LP: 2.94e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 4.72e-01, LP: 3.29e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 5.55e-01, LP: 3.20e-01
    Verify bs=4 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=4) → 300 steps
      Key: 3.73e-01, LP: 3.07e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 6.90e-01, LP: 2.14e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 3.51e-01, LP: 2.80e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 6.77e-01, LP: 3.52e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 4.50e-01, LP: 3.03e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 4.93e-01, LP: 2.86e-01

  Claimed batch size: 5
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 5.78e-01, LP: 1.65e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 3.77e-01, LP: 2.27e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 6.07e-01, LP: 1.91e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 6.53e-01, LP: 2.18e-01
    Verify bs=5 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=5) → 300 steps
      Key: 6.31e-01, LP: 1.25e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 5.74e-01, LP: 2.71e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 6.01e-01, LP: 1.67e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 6.44e-01, LP: 1.59e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 6.13e-01, LP: 2.09e-01

  Claimed batch size: 8
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 4.74e-01, LP: 1.86e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 4.49e-01, LP: 3.02e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 5.37e-01, LP: 2.43e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 4.65e-01, LP: 1.93e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 5.76e-01, LP: 1.99e-01
    Verify bs=8 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=8) → 300 steps
      Key: 1.07e+00, LP: 1.69e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 4.45e-01, LP: 1.86e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 4.65e-01, LP: 1.69e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 3.75e-01, LP: 2.88e-01

  Claimed batch size: 9
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 4.74e-01, LP: 1.86e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 4.49e-01, LP: 3.02e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 5.37e-01, LP: 2.43e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 4.65e-01, LP: 1.93e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 5.76e-01, LP: 1.99e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 1.07e+00, LP: 1.69e-01
    Verify bs=9 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=9) → 300 steps
      Key: 4.45e-01, LP: 1.86e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 4.65e-01, LP: 1.69e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 3.75e-01, LP: 2.88e-01

  Claimed batch size: 16
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 4.15e-01, LP: 1.82e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 4.27e-01, LP: 2.41e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 5.08e-01, LP: 2.40e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 4.07e-01, LP: 1.58e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 5.10e-01, LP: 2.85e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 4.80e-01, LP: 2.43e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 4.74e-01, LP: 2.71e-01
    Verify bs=16 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=16) → 300 steps
      Key: 4.47e-01, LP: 1.81e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 5.03e-01, LP: 2.74e-01

  Claimed batch size: 17
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 4.33e-01, LP: 1.95e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 6.63e-01, LP: 2.17e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 3.29e-01, LP: 1.79e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 3.27e-01, LP: 1.94e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 3.44e-01, LP: 1.48e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 4.15e-01, LP: 2.33e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 4.44e-01, LP: 1.36e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 3.46e-01, LP: 1.97e-01
    Verify bs=17 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=17) → 300 steps
      Key: 4.40e-01, LP: 2.25e-01

================================================================================
REFERENCE: ref_1
================================================================================

  Claimed batch size: 1
    Verify bs=1 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=1) → 300 steps
      Key: 2.89e-01, LP: 1.01e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 2.84e-01, LP: 3.09e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 3.32e-01, LP: 2.96e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 3.32e-01, LP: 2.00e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 3.25e-01, LP: 1.64e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 2.62e-01, LP: 2.20e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 3.24e-01, LP: 1.99e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 2.96e-01, LP: 1.73e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 3.52e-01, LP: 8.86e-02

  Claimed batch size: 2
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 4.71e-01, LP: 2.18e-01
    Verify bs=2 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=2) → 300 steps
      Key: 4.35e-01, LP: 1.92e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 4.00e-01, LP: 1.61e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 4.52e-01, LP: 2.93e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 4.06e-01, LP: 1.49e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 4.74e-01, LP: 2.25e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 4.40e-01, LP: 2.89e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 5.22e-01, LP: 2.56e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 4.41e-01, LP: 2.30e-01

  Claimed batch size: 3
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 2.94e-01, LP: 1.91e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 3.75e-01, LP: 2.33e-01
    Verify bs=3 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=3) → 300 steps
      Key: 3.16e-01, LP: 1.16e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 3.55e-01, LP: 1.64e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 2.91e-01, LP: 1.32e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 3.27e-01, LP: 1.67e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 3.37e-01, LP: 2.11e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 3.29e-01, LP: 1.75e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 3.26e-01, LP: 7.41e-02

  Claimed batch size: 4
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 2.52e-01, LP: 1.04e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 3.36e-01, LP: 2.60e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 2.86e-01, LP: 2.82e-01
    Verify bs=4 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=4) → 300 steps
      Key: 6.12e-01, LP: 1.88e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 2.54e-01, LP: 2.89e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 2.70e-01, LP: 1.94e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 5.62e-01, LP: 2.37e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 2.67e-01, LP: 1.42e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 2.38e-01, LP: 2.69e-01

  Claimed batch size: 5
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 5.10e-01, LP: 3.59e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 4.75e-01, LP: 3.13e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 3.93e-01, LP: 2.51e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 4.17e-01, LP: 3.04e-01
    Verify bs=5 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=5) → 300 steps
      Key: 4.38e-01, LP: 4.82e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 4.34e-01, LP: 4.15e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 4.31e-01, LP: 3.32e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 4.17e-01, LP: 4.09e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 3.83e-01, LP: 2.42e-01

  Claimed batch size: 8
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 3.31e-01, LP: 1.13e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 4.63e-01, LP: 1.07e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 3.76e-01, LP: 1.38e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 3.99e-01, LP: 1.90e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 3.40e-01, LP: 1.24e-01
    Verify bs=8 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=8) → 300 steps
      Key: 3.39e-01, LP: 1.11e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 4.63e-01, LP: 1.83e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 3.69e-01, LP: 1.50e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 4.19e-01, LP: 9.78e-02

  Claimed batch size: 9
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 3.31e-01, LP: 1.13e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 4.63e-01, LP: 1.07e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 3.76e-01, LP: 1.38e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 3.99e-01, LP: 1.90e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 3.40e-01, LP: 1.24e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 3.39e-01, LP: 1.11e-01
    Verify bs=9 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=9) → 300 steps
      Key: 4.63e-01, LP: 1.83e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 3.69e-01, LP: 1.50e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 4.19e-01, LP: 9.78e-02

  Claimed batch size: 16
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 2.99e-01, LP: 2.07e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 3.33e-01, LP: 2.37e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 3.91e-01, LP: 1.52e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 2.91e-01, LP: 2.10e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 2.95e-01, LP: 1.65e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 4.48e-01, LP: 1.52e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 4.57e-01, LP: 1.86e-01
    Verify bs=16 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=16) → 300 steps
      Key: 4.11e-01, LP: 1.42e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 3.20e-01, LP: 2.83e-01

  Claimed batch size: 17
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 6.98e-01, LP: 1.37e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 6.30e-01, LP: 1.88e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 6.93e-01, LP: 1.54e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 6.74e-01, LP: 7.74e-02
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 6.95e-01, LP: 2.91e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 6.94e-01, LP: 2.07e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 6.61e-01, LP: 1.90e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 5.85e-01, LP: 2.08e-01
    Verify bs=17 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=17) → 300 steps
      Key: 6.99e-01, LP: 1.55e-01

================================================================================
REFERENCE: ref_2
================================================================================

  Claimed batch size: 1
    Verify bs=1 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=1) → 300 steps
      Key: 5.82e-01, LP: 2.93e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 5.55e-01, LP: 2.87e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 4.93e-01, LP: 2.43e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 6.33e-01, LP: 2.14e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 4.12e-01, LP: 2.29e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 6.14e-01, LP: 2.33e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 8.77e-01, LP: 1.94e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 3.76e-01, LP: 3.13e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 6.18e-01, LP: 1.56e-01

  Claimed batch size: 2
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 4.67e-01, LP: 2.43e-01
    Verify bs=2 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=2) → 300 steps
      Key: 4.19e-01, LP: 2.15e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 4.75e-01, LP: 2.24e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 5.60e-01, LP: 3.76e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 4.26e-01, LP: 2.74e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 4.29e-01, LP: 3.57e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 7.04e-01, LP: 2.73e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 6.52e-01, LP: 2.81e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 7.11e-01, LP: 3.25e-01

  Claimed batch size: 3
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 4.15e-01, LP: 2.12e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 3.58e-01, LP: 2.33e-01
    Verify bs=3 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=3) → 300 steps
      Key: 4.03e-01, LP: 2.46e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 4.65e-01, LP: 2.62e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 3.85e-01, LP: 1.93e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 3.87e-01, LP: 2.62e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 3.86e-01, LP: 2.59e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 4.21e-01, LP: 2.07e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 4.13e-01, LP: 2.95e-01

  Claimed batch size: 4
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 5.74e-01, LP: 2.58e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 3.26e-01, LP: 3.76e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 3.31e-01, LP: 3.20e-01
    Verify bs=4 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=4) → 300 steps
      Key: 6.08e-01, LP: 2.24e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 3.44e-01, LP: 1.89e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 5.62e-01, LP: 3.18e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 3.11e-01, LP: 4.01e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 3.06e-01, LP: 2.61e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 5.71e-01, LP: 2.13e-01

  Claimed batch size: 5
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 3.85e-01, LP: 2.56e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 3.87e-01, LP: 1.77e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 5.93e-01, LP: 2.84e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 7.38e-01, LP: 1.56e-01
    Verify bs=5 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=5) → 300 steps
      Key: 4.20e-01, LP: 2.62e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 4.85e-01, LP: 2.07e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 4.06e-01, LP: 2.53e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 3.88e-01, LP: 1.42e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 3.89e-01, LP: 2.03e-01

  Claimed batch size: 8
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 4.35e-01, LP: 1.52e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 4.33e-01, LP: 2.81e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 4.59e-01, LP: 1.31e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 4.40e-01, LP: 3.00e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 4.43e-01, LP: 2.22e-01
    Verify bs=8 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=8) → 300 steps
      Key: 4.22e-01, LP: 2.46e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 4.49e-01, LP: 2.71e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 4.68e-01, LP: 2.49e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 4.62e-01, LP: 1.84e-01

  Claimed batch size: 9
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 4.35e-01, LP: 1.52e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 4.33e-01, LP: 2.81e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 4.59e-01, LP: 1.31e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 4.40e-01, LP: 3.00e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 4.43e-01, LP: 2.22e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 4.22e-01, LP: 2.46e-01
    Verify bs=9 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=9) → 300 steps
      Key: 4.49e-01, LP: 2.71e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 4.68e-01, LP: 2.49e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 4.62e-01, LP: 1.84e-01

  Claimed batch size: 16
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 6.76e-01, LP: 1.84e-01
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 4.57e-01, LP: 1.67e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 4.76e-01, LP: 1.25e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 4.52e-01, LP: 2.11e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 4.75e-01, LP: 1.57e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 4.63e-01, LP: 1.84e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 4.52e-01, LP: 1.25e-01
    Verify bs=16 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=16) → 300 steps
      Key: 4.90e-01, LP: 1.74e-01
    Verify bs=17 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=17) → 300 steps
      Key: 4.76e-01, LP: 1.44e-01

  Claimed batch size: 17
    Verify bs=1 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=1) → 300 steps
      Key: 4.30e-01, LP: 8.88e-02
    Verify bs=2 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=2) → 300 steps
      Key: 5.90e-01, LP: 2.29e-01
    Verify bs=3 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=3) → 300 steps
      Key: 9.15e-01, LP: 1.67e-01
    Verify bs=4 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=4) → 300 steps
      Key: 4.06e-01, LP: 2.21e-01
    Verify bs=5 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=5) → 300 steps
      Key: 4.89e-01, LP: 2.12e-01
    Verify bs=8 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=8) → 300 steps
      Key: 4.99e-01, LP: 1.98e-01
    Verify bs=9 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=9) → 300 steps
      Key: 8.79e-01, LP: 1.39e-01
    Verify bs=16 (off):      Prompt: 8067, Gen: 300, arb neighbors (bs=16) → 300 steps
      Key: 5.29e-01, LP: 1.48e-01
    Verify bs=17 (diag):      Prompt: 8067, Gen: 300, exact neighbors (bs=17) → 300 steps
      Key: 3.49e-01, LP: 1.05e-01

================================================================================
CROSS-HARDWARE BATCH SIZE DETECTABILITY (PREFILL)
================================================================================

================================================================================
REF_0
================================================================================

Key Vectors (mean L2):
              v_bs=  1 v_bs=  2 v_bs=  3 v_bs=  4 v_bs=  5 v_bs=  8 v_bs=  9 v_bs= 16 v_bs= 17 
c_bs=1     3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01
c_bs=2     3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01
c_bs=3     3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01
c_bs=4     3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01
c_bs=5     3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01
c_bs=8     3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01
c_bs=9     3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01
c_bs=16    3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01
c_bs=17    3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01  3.82e-01

Logprobs (mean L2):
              v_bs=  1 v_bs=  2 v_bs=  3 v_bs=  4 v_bs=  5 v_bs=  8 v_bs=  9 v_bs= 16 v_bs= 17 
c_bs=1     4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01
c_bs=2     4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01
c_bs=3     4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01
c_bs=4     4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01
c_bs=5     4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01
c_bs=8     4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01
c_bs=9     4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01
c_bs=16    4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01
c_bs=17    4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01  4.70e-01

================================================================================
REF_1
================================================================================

Key Vectors (mean L2):
              v_bs=  1 v_bs=  2 v_bs=  3 v_bs=  4 v_bs=  5 v_bs=  8 v_bs=  9 v_bs= 16 v_bs= 17 
c_bs=1     1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00
c_bs=2     1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00
c_bs=3     1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00
c_bs=4     1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00
c_bs=5     1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00
c_bs=8     1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00
c_bs=9     1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00
c_bs=16    1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00
c_bs=17    1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00  1.25e+00

Logprobs (mean L2):
              v_bs=  1 v_bs=  2 v_bs=  3 v_bs=  4 v_bs=  5 v_bs=  8 v_bs=  9 v_bs= 16 v_bs= 17 
c_bs=1     2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01
c_bs=2     2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01
c_bs=3     2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01
c_bs=4     2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01
c_bs=5     2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01
c_bs=8     2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01
c_bs=9     2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01
c_bs=16    2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01
c_bs=17    2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01  2.51e-01

================================================================================
REF_2
================================================================================

Key Vectors (mean L2):
              v_bs=  1 v_bs=  2 v_bs=  3 v_bs=  4 v_bs=  5 v_bs=  8 v_bs=  9 v_bs= 16 v_bs= 17 
c_bs=1     9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01
c_bs=2     9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01
c_bs=3     9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01
c_bs=4     9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01
c_bs=5     9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01
c_bs=8     9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01
c_bs=9     9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01
c_bs=16    9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01
c_bs=17    9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01  9.46e-01

Logprobs (mean L2):
              v_bs=  1 v_bs=  2 v_bs=  3 v_bs=  4 v_bs=  5 v_bs=  8 v_bs=  9 v_bs= 16 v_bs= 17 
c_bs=1     3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01
c_bs=2     3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01
c_bs=3     3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01
c_bs=4     3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01
c_bs=5     3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01
c_bs=8     3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01
c_bs=9     3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01
c_bs=16    3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01
c_bs=17    3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01  3.91e-01

================================================================================
AGGREGATE (average across references):
================================================================================

Key Vectors (mean L2):
              v_bs=  1 v_bs=  2 v_bs=  3 v_bs=  4 v_bs=  5 v_bs=  8 v_bs=  9 v_bs= 16 v_bs= 17 
c_bs=1     8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01
c_bs=2     8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01
c_bs=3     8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01
c_bs=4     8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01
c_bs=5     8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01
c_bs=8     8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01
c_bs=9     8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01
c_bs=16    8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01
c_bs=17    8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01  8.59e-01

Logprobs (mean L2):
              v_bs=  1 v_bs=  2 v_bs=  3 v_bs=  4 v_bs=  5 v_bs=  8 v_bs=  9 v_bs= 16 v_bs= 17 
c_bs=1     3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01
c_bs=2     3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01
c_bs=3     3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01
c_bs=4     3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01
c_bs=5     3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01
c_bs=8     3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01
c_bs=9     3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01
c_bs=16    3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01
c_bs=17    3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01  3.71e-01

================================================================================
SNR ANALYSIS
================================================================================

Diagonal (baseline = cross-hardware, same batch size):
  Key vectors: 8.59e-01
  Logprobs: 3.71e-01

Off-diagonal (all pairs):
  Key vectors - Mean: 8.59e-01, SNR: 1.00×
  Logprobs - Mean: 3.71e-01, SNR: 1.00×

Excluded equivalent pairs (same kernel within-hardware):
  (1, 2) and (2, 1)
  (1, 3) and (3, 1)
  (1, 4) and (4, 1)
  (1, 5) and (5, 1)
  (1, 8) and (8, 1)
  (1, 9) and (9, 1)
  (1, 16) and (16, 1)
  (1, 17) and (17, 1)
  (2, 3) and (3, 2)
  (2, 4) and (4, 2)
  (2, 5) and (5, 2)
  (2, 8) and (8, 2)
  (2, 9) and (9, 2)
  (2, 16) and (16, 2)
  (2, 17) and (17, 2)
  (3, 4) and (4, 3)
  (3, 5) and (5, 3)
  (3, 8) and (8, 3)
  (3, 9) and (9, 3)
  (3, 16) and (16, 3)
  (3, 17) and (17, 3)
  (4, 5) and (5, 4)
  (4, 8) and (8, 4)
  (4, 9) and (9, 4)
  (4, 16) and (16, 4)
  (4, 17) and (17, 4)
  (5, 8) and (8, 5)
  (5, 9) and (9, 5)
  (5, 16) and (16, 5)
  (5, 17) and (17, 5)
  (8, 9) and (9, 8)
  (8, 16) and (16, 8)
  (8, 17) and (17, 8)
  (9, 16) and (16, 9)
  (9, 17) and (17, 9)
  (16, 17) and (17, 16)
  Total excluded: 72 cells

================================================================================
CROSS-HARDWARE BATCH SIZE DETECTABILITY (DECODE)
================================================================================

================================================================================
REF_0
================================================================================

Key Vectors (mean L2):
              v_bs=  1 v_bs=  2 v_bs=  3 v_bs=  4 v_bs=  5 v_bs=  8 v_bs=  9 v_bs= 16 v_bs= 17 
c_bs=1     5.60e-01  5.91e-01  5.57e-01  5.50e-01  5.46e-01  5.31e-01  5.41e-01  3.03e-01  5.22e-01
c_bs=2     4.16e-01  6.51e-01  3.37e-01  3.29e-01  3.54e-01  4.34e-01  4.34e-01  3.17e-01  4.33e-01
c_bs=3     1.13e+00  1.18e+00  1.11e+00  1.12e+00  1.40e+00  1.13e+00  3.20e-01  6.06e-01  1.13e+00
c_bs=4     5.50e-01  4.72e-01  5.55e-01  3.73e-01  6.90e-01  3.51e-01  6.77e-01  4.50e-01  4.93e-01
c_bs=5     5.78e-01  3.77e-01  6.07e-01  6.53e-01  6.31e-01  5.74e-01  6.01e-01  6.44e-01  6.13e-01
c_bs=8     4.74e-01  4.49e-01  5.37e-01  4.65e-01  5.76e-01  1.07e+00  4.45e-01  4.65e-01  3.75e-01
c_bs=9     4.74e-01  4.49e-01  5.37e-01  4.65e-01  5.76e-01  1.07e+00  4.45e-01  4.65e-01  3.75e-01
c_bs=16    4.15e-01  4.27e-01  5.08e-01  4.07e-01  5.10e-01  4.80e-01  4.74e-01  4.47e-01  5.03e-01
c_bs=17    4.33e-01  6.63e-01  3.29e-01  3.27e-01  3.44e-01  4.15e-01  4.44e-01  3.46e-01  4.40e-01

Logprobs (mean L2):
              v_bs=  1 v_bs=  2 v_bs=  3 v_bs=  4 v_bs=  5 v_bs=  8 v_bs=  9 v_bs= 16 v_bs= 17 
c_bs=1     2.16e-01  2.54e-01  1.84e-01  1.93e-01  2.02e-01  2.27e-01  1.67e-01  2.27e-01  1.67e-01
c_bs=2     1.70e-01  1.77e-01  1.72e-01  2.19e-01  1.64e-01  2.22e-01  1.61e-01  2.03e-01  1.97e-01
c_bs=3     1.32e-01  1.73e-01  1.42e-01  1.96e-01  2.01e-01  1.18e-01  1.42e-01  1.67e-01  1.90e-01
c_bs=4     2.94e-01  3.29e-01  3.20e-01  3.07e-01  2.14e-01  2.80e-01  3.52e-01  3.03e-01  2.86e-01
c_bs=5     1.65e-01  2.27e-01  1.91e-01  2.18e-01  1.25e-01  2.71e-01  1.67e-01  1.59e-01  2.09e-01
c_bs=8     1.86e-01  3.02e-01  2.43e-01  1.93e-01  1.99e-01  1.69e-01  1.86e-01  1.69e-01  2.88e-01
c_bs=9     1.86e-01  3.02e-01  2.43e-01  1.93e-01  1.99e-01  1.69e-01  1.86e-01  1.69e-01  2.88e-01
c_bs=16    1.82e-01  2.41e-01  2.40e-01  1.58e-01  2.85e-01  2.43e-01  2.71e-01  1.81e-01  2.74e-01
c_bs=17    1.95e-01  2.17e-01  1.79e-01  1.94e-01  1.48e-01  2.33e-01  1.36e-01  1.97e-01  2.25e-01

================================================================================
REF_1
================================================================================

Key Vectors (mean L2):
              v_bs=  1 v_bs=  2 v_bs=  3 v_bs=  4 v_bs=  5 v_bs=  8 v_bs=  9 v_bs= 16 v_bs= 17 
c_bs=1     2.89e-01  2.84e-01  3.32e-01  3.32e-01  3.25e-01  2.62e-01  3.24e-01  2.96e-01  3.52e-01
c_bs=2     4.71e-01  4.35e-01  4.00e-01  4.52e-01  4.06e-01  4.74e-01  4.40e-01  5.22e-01  4.41e-01
c_bs=3     2.94e-01  3.75e-01  3.16e-01  3.55e-01  2.91e-01  3.27e-01  3.37e-01  3.29e-01  3.26e-01
c_bs=4     2.52e-01  3.36e-01  2.86e-01  6.12e-01  2.54e-01  2.70e-01  5.62e-01  2.67e-01  2.38e-01
c_bs=5     5.10e-01  4.75e-01  3.93e-01  4.17e-01  4.38e-01  4.34e-01  4.31e-01  4.17e-01  3.83e-01
c_bs=8     3.31e-01  4.63e-01  3.76e-01  3.99e-01  3.40e-01  3.39e-01  4.63e-01  3.69e-01  4.19e-01
c_bs=9     3.31e-01  4.63e-01  3.76e-01  3.99e-01  3.40e-01  3.39e-01  4.63e-01  3.69e-01  4.19e-01
c_bs=16    2.99e-01  3.33e-01  3.91e-01  2.91e-01  2.95e-01  4.48e-01  4.57e-01  4.11e-01  3.20e-01
c_bs=17    6.98e-01  6.30e-01  6.93e-01  6.74e-01  6.95e-01  6.94e-01  6.61e-01  5.85e-01  6.99e-01

Logprobs (mean L2):
              v_bs=  1 v_bs=  2 v_bs=  3 v_bs=  4 v_bs=  5 v_bs=  8 v_bs=  9 v_bs= 16 v_bs= 17 
c_bs=1     1.01e-01  3.09e-01  2.96e-01  2.00e-01  1.64e-01  2.20e-01  1.99e-01  1.73e-01  8.86e-02
c_bs=2     2.18e-01  1.92e-01  1.61e-01  2.93e-01  1.49e-01  2.25e-01  2.89e-01  2.56e-01  2.30e-01
c_bs=3     1.91e-01  2.33e-01  1.16e-01  1.64e-01  1.32e-01  1.67e-01  2.11e-01  1.75e-01  7.41e-02
c_bs=4     1.04e-01  2.60e-01  2.82e-01  1.88e-01  2.89e-01  1.94e-01  2.37e-01  1.42e-01  2.69e-01
c_bs=5     3.59e-01  3.13e-01  2.51e-01  3.04e-01  4.82e-01  4.15e-01  3.32e-01  4.09e-01  2.42e-01
c_bs=8     1.13e-01  1.07e-01  1.38e-01  1.90e-01  1.24e-01  1.11e-01  1.83e-01  1.50e-01  9.78e-02
c_bs=9     1.13e-01  1.07e-01  1.38e-01  1.90e-01  1.24e-01  1.11e-01  1.83e-01  1.50e-01  9.78e-02
c_bs=16    2.07e-01  2.37e-01  1.52e-01  2.10e-01  1.65e-01  1.52e-01  1.86e-01  1.42e-01  2.83e-01
c_bs=17    1.37e-01  1.88e-01  1.54e-01  7.74e-02  2.91e-01  2.07e-01  1.90e-01  2.08e-01  1.55e-01

================================================================================
REF_2
================================================================================

Key Vectors (mean L2):
              v_bs=  1 v_bs=  2 v_bs=  3 v_bs=  4 v_bs=  5 v_bs=  8 v_bs=  9 v_bs= 16 v_bs= 17 
c_bs=1     5.82e-01  5.55e-01  4.93e-01  6.33e-01  4.12e-01  6.14e-01  8.77e-01  3.76e-01  6.18e-01
c_bs=2     4.67e-01  4.19e-01  4.75e-01  5.60e-01  4.26e-01  4.29e-01  7.04e-01  6.52e-01  7.11e-01
c_bs=3     4.15e-01  3.58e-01  4.03e-01  4.65e-01  3.85e-01  3.87e-01  3.86e-01  4.21e-01  4.13e-01
c_bs=4     5.74e-01  3.26e-01  3.31e-01  6.08e-01  3.44e-01  5.62e-01  3.11e-01  3.06e-01  5.71e-01
c_bs=5     3.85e-01  3.87e-01  5.93e-01  7.38e-01  4.20e-01  4.85e-01  4.06e-01  3.88e-01  3.89e-01
c_bs=8     4.35e-01  4.33e-01  4.59e-01  4.40e-01  4.43e-01  4.22e-01  4.49e-01  4.68e-01  4.62e-01
c_bs=9     4.35e-01  4.33e-01  4.59e-01  4.40e-01  4.43e-01  4.22e-01  4.49e-01  4.68e-01  4.62e-01
c_bs=16    6.76e-01  4.57e-01  4.76e-01  4.52e-01  4.75e-01  4.63e-01  4.52e-01  4.90e-01  4.76e-01
c_bs=17    4.30e-01  5.90e-01  9.15e-01  4.06e-01  4.89e-01  4.99e-01  8.79e-01  5.29e-01  3.49e-01

Logprobs (mean L2):
              v_bs=  1 v_bs=  2 v_bs=  3 v_bs=  4 v_bs=  5 v_bs=  8 v_bs=  9 v_bs= 16 v_bs= 17 
c_bs=1     2.93e-01  2.87e-01  2.43e-01  2.14e-01  2.29e-01  2.33e-01  1.94e-01  3.13e-01  1.56e-01
c_bs=2     2.43e-01  2.15e-01  2.24e-01  3.76e-01  2.74e-01  3.57e-01  2.73e-01  2.81e-01  3.25e-01
c_bs=3     2.12e-01  2.33e-01  2.46e-01  2.62e-01  1.93e-01  2.62e-01  2.59e-01  2.07e-01  2.95e-01
c_bs=4     2.58e-01  3.76e-01  3.20e-01  2.24e-01  1.89e-01  3.18e-01  4.01e-01  2.61e-01  2.13e-01
c_bs=5     2.56e-01  1.77e-01  2.84e-01  1.56e-01  2.62e-01  2.07e-01  2.53e-01  1.42e-01  2.03e-01
c_bs=8     1.52e-01  2.81e-01  1.31e-01  3.00e-01  2.22e-01  2.46e-01  2.71e-01  2.49e-01  1.84e-01
c_bs=9     1.52e-01  2.81e-01  1.31e-01  3.00e-01  2.22e-01  2.46e-01  2.71e-01  2.49e-01  1.84e-01
c_bs=16    1.84e-01  1.67e-01  1.25e-01  2.11e-01  1.57e-01  1.84e-01  1.25e-01  1.74e-01  1.44e-01
c_bs=17    8.88e-02  2.29e-01  1.67e-01  2.21e-01  2.12e-01  1.98e-01  1.39e-01  1.48e-01  1.05e-01

================================================================================
AGGREGATE (average across references):
================================================================================

Key Vectors (mean L2):
              v_bs=  1 v_bs=  2 v_bs=  3 v_bs=  4 v_bs=  5 v_bs=  8 v_bs=  9 v_bs= 16 v_bs= 17 
c_bs=1     4.77e-01  4.77e-01  4.61e-01  5.05e-01  4.28e-01  4.69e-01  5.80e-01  3.25e-01  4.97e-01
c_bs=2     4.51e-01  5.02e-01  4.04e-01  4.47e-01  3.96e-01  4.46e-01  5.26e-01  4.97e-01  5.28e-01
c_bs=3     6.13e-01  6.36e-01  6.10e-01  6.46e-01  6.92e-01  6.14e-01  3.47e-01  4.52e-01  6.22e-01
c_bs=4     4.59e-01  3.78e-01  3.91e-01  5.31e-01  4.29e-01  3.94e-01  5.17e-01  3.41e-01  4.34e-01
c_bs=5     4.91e-01  4.13e-01  5.31e-01  6.02e-01  4.96e-01  4.98e-01  4.79e-01  4.83e-01  4.62e-01
c_bs=8     4.14e-01  4.48e-01  4.57e-01  4.35e-01  4.53e-01  6.10e-01  4.52e-01  4.34e-01  4.19e-01
c_bs=9     4.14e-01  4.48e-01  4.57e-01  4.35e-01  4.53e-01  6.10e-01  4.52e-01  4.34e-01  4.19e-01
c_bs=16    4.63e-01  4.05e-01  4.58e-01  3.83e-01  4.27e-01  4.64e-01  4.61e-01  4.49e-01  4.33e-01
c_bs=17    5.20e-01  6.28e-01  6.46e-01  4.69e-01  5.09e-01  5.36e-01  6.62e-01  4.87e-01  4.96e-01

Logprobs (mean L2):
              v_bs=  1 v_bs=  2 v_bs=  3 v_bs=  4 v_bs=  5 v_bs=  8 v_bs=  9 v_bs= 16 v_bs= 17 
c_bs=1     2.03e-01  2.83e-01  2.41e-01  2.03e-01  1.98e-01  2.27e-01  1.86e-01  2.38e-01  1.37e-01
c_bs=2     2.11e-01  1.94e-01  1.86e-01  2.96e-01  1.96e-01  2.68e-01  2.41e-01  2.47e-01  2.51e-01
c_bs=3     1.78e-01  2.13e-01  1.68e-01  2.07e-01  1.75e-01  1.82e-01  2.04e-01  1.83e-01  1.86e-01
c_bs=4     2.19e-01  3.22e-01  3.07e-01  2.40e-01  2.31e-01  2.64e-01  3.30e-01  2.35e-01  2.56e-01
c_bs=5     2.60e-01  2.39e-01  2.42e-01  2.26e-01  2.90e-01  2.98e-01  2.51e-01  2.37e-01  2.18e-01
c_bs=8     1.50e-01  2.30e-01  1.71e-01  2.28e-01  1.82e-01  1.75e-01  2.14e-01  1.89e-01  1.90e-01
c_bs=9     1.50e-01  2.30e-01  1.71e-01  2.28e-01  1.82e-01  1.75e-01  2.14e-01  1.89e-01  1.90e-01
c_bs=16    1.91e-01  2.15e-01  1.72e-01  1.93e-01  2.02e-01  1.93e-01  1.94e-01  1.66e-01  2.34e-01
c_bs=17    1.40e-01  2.11e-01  1.67e-01  1.64e-01  2.17e-01  2.13e-01  1.55e-01  1.84e-01  1.62e-01

================================================================================
SNR ANALYSIS
================================================================================

Diagonal (baseline = cross-hardware, same batch size):
  Key vectors: 5.14e-01
  Logprobs: 2.01e-01

Off-diagonal (all pairs):
  Key vectors - Mean: 4.79e-01, SNR: 0.93×
  Logprobs - Mean: 2.14e-01, SNR: 1.06×

Excluded equivalent pairs (same kernel within-hardware):
  (8, 9) and (9, 8)
  Total excluded: 2 cells

Off-diagonal (meaningful pairs only):
  Count: 70
  Key vectors - Mean: 4.78e-01, SNR: 0.93×
  Logprobs - Mean: 2.14e-01, SNR: 1.06×

================================================================================
PREFILL vs DECODE COMPARISON (meaningful SNR)
================================================================================
Prefill - Key: 1.00×, LP: 1.00×
Decode  - Key: 0.93×, LP: 1.06×

✓ Results saved to: /workspace/experiments/verify_20251126_184615.json
