Prefill vs Decode: Batch Size Detectability
This experiment tests whether a verifier using prefill (parallel forward pass) can detect the batch size used during decode (autoregressive generation) by comparing key vectors and logprobs. While batch size does affect activations within each mode (decode-decode or prefill-prefill comparisons show clear differences), the baseline noise from the decode-vs-prefill mode difference (~0.2-1.0 L2) overwhelms the batch size signal, yielding SNR ≈ 1 Conclusion: Prefill cannot reliably verify decode batch size—the inference mode difference is the dominant source of variation.

You will see slightly different SNR values for repetitions of this experiment for different configurations (sequence lengths, tested batch sizes etc.). But they will all be around 1, meaning that the baseline noise across modes exceeds whatever signal you get from batch size difference. 
